ðŸ” Retour au [Sommaire](/SOMMAIRE.md)

# 3.12.3 Protocoles Ã  Ã©tat de lien : OSPF

## Introduction

Imaginez deux faÃ§ons de naviguer dans une ville inconnue :

**MÃ©thode 1** (RIP - vecteur de distance) : Vous demandez votre chemin Ã  chaque carrefour. Chaque personne vous dit "Allez tout droit pendant 3 rues", mais personne ne connaÃ®t vraiment le plan complet de la ville.

**MÃ©thode 2** (OSPF - Ã©tat de lien) : Vous avez une carte complÃ¨te de la ville avec toutes les rues, les distances, et mÃªme l'Ã©tat du trafic. Vous calculez vous-mÃªme le meilleur itinÃ©raire vers n'importe quelle destination.

Les **protocoles Ã  Ã©tat de lien** utilisent cette deuxiÃ¨me approche : chaque routeur construit une carte complÃ¨te du rÃ©seau et calcule lui-mÃªme les meilleurs chemins.

## Qu'est-ce qu'un protocole Ã  Ã©tat de lien ?

### DÃ©finition

Un **protocole Ã  Ã©tat de lien** (link-state protocol) est un type de protocole de routage oÃ¹ :
- Chaque routeur dÃ©couvre ses **voisins directs**
- Chaque routeur mesure le **coÃ»t des liens** vers ses voisins
- Chaque routeur partage ces informations avec **TOUS les autres routeurs** du rÃ©seau
- Chaque routeur construit une **carte complÃ¨te** (topologie) du rÃ©seau
- Chaque routeur calcule **indÃ©pendamment** les meilleurs chemins vers toutes les destinations

### DiffÃ©rence fondamentale avec le vecteur de distance

| Aspect | Vecteur de distance (RIP) | Ã‰tat de lien (OSPF) |
|--------|---------------------------|---------------------|
| **Information partagÃ©e** | "Voici les destinations que je connais" | "Voici les liens que je vois" |
| **PortÃ©e du partage** | Uniquement aux voisins directs | Ã€ tous les routeurs |
| **Connaissance** | Routes apprises des voisins | Topologie complÃ¨te |
| **Calcul** | BasÃ© sur les infos des voisins | Calcul indÃ©pendant |
| **Analogie** | Bouche-Ã -oreille | Atlas complet |

### Analogie : Le rÃ©seau routier national

**Avec RIP (vecteur de distance)** :
- Chaque ville ne connaÃ®t que les villes voisines
- Les informations se propagent de proche en proche
- Vous faites confiance aux panneaux installÃ©s par d'autres
- Pas de vue d'ensemble

**Avec OSPF (Ã©tat de lien)** :
- Chaque ville a une carte complÃ¨te du pays
- Toutes les villes partagent l'Ã©tat de leurs routes
- Chaque ville calcule elle-mÃªme le meilleur chemin
- Vue d'ensemble complÃ¨te

## OSPF (Open Shortest Path First)

### PrÃ©sentation

**OSPF** est le protocole Ã  Ã©tat de lien le plus utilisÃ© dans les rÃ©seaux d'entreprise. Il a Ã©tÃ© conÃ§u pour remplacer RIP et corriger ses nombreuses limitations.

**CaractÃ©ristiques gÃ©nÃ©rales** :

| CaractÃ©ristique | Valeur |
|-----------------|---------|
| **Type** | Ã‰tat de lien (Link-State) |
| **Standard** | RFC 2328 (OSPFv2), RFC 5340 (OSPFv3) |
| **MÃ©trique** | CoÃ»t basÃ© sur la bande passante |
| **Algorithme** | Dijkstra (SPF - Shortest Path First) |
| **Protocole** | Directement sur IP (protocole 89) |
| **HiÃ©rarchie** | Oui (aires) |
| **Convergence** | Rapide (secondes) |
| **ScalabilitÃ©** | Excellente |

### Signification du nom

**O**pen **S**hortest **P**ath **F**irst :
- **Open** : Standard ouvert, non propriÃ©taire
- **Shortest Path First** : Trouve le chemin le plus court (moindre coÃ»t)
- BasÃ© sur l'algorithme de Dijkstra

## Les concepts fondamentaux d'OSPF

### 1. LSA (Link-State Advertisement)

Un **LSA** est un message contenant des informations sur l'Ã©tat d'un lien.

**Analogie** : C'est comme un bulletin d'information routier : "La route D117 entre Ville A et Ville B est ouverte, longue de 50 km, vitesse limitÃ©e Ã  90 km/h"

**Contenu d'un LSA** :
- IdentitÃ© du routeur qui l'envoie
- Liste de ses liens (interfaces)
- Ã‰tat de chaque lien (up/down)
- CoÃ»t de chaque lien
- RÃ©seaux connectÃ©s

**Exemple de LSA** :
```
Routeur ID : 1.1.1.1
Lien 1 : vers Routeur 2.2.2.2, coÃ»t 10, Ã©tat UP
Lien 2 : vers Routeur 3.3.3.3, coÃ»t 20, Ã©tat UP
RÃ©seau : 192.168.1.0/24, connectÃ© directement
```

### 2. LSDB (Link-State Database)

La **LSDB** est la base de donnÃ©es contenant tous les LSA reÃ§us de tous les routeurs.

**Analogie** : C'est comme une bibliothÃ¨que centrale oÃ¹ sont stockÃ©s tous les bulletins routiers de toutes les villes. Avec tous ces bulletins, vous pouvez reconstruire la carte complÃ¨te du pays.

**CaractÃ©ristique importante** : Tous les routeurs dans une mÃªme aire OSPF ont une **LSDB identique**. Ils ont tous la mÃªme carte !

```
LSDB du Routeur A :
- LSA de Routeur A (moi-mÃªme)
- LSA de Routeur B
- LSA de Routeur C
- LSA de Routeur D
- LSA de Routeur E

LSDB du Routeur B :
- LSA de Routeur A
- LSA de Routeur B (moi-mÃªme)
- LSA de Routeur C
- LSA de Routeur D
- LSA de Routeur E

â†’ MÃªmes informations = mÃªme vue du rÃ©seau
```

### 3. Algorithme de Dijkstra (SPF)

Une fois la LSDB complÃ¨te, chaque routeur utilise l'**algorithme de Dijkstra** pour calculer le chemin le plus court vers chaque destination.

**Analogie** : C'est comme votre GPS qui, Ã  partir de la carte complÃ¨te, calcule le meilleur itinÃ©raire en tenant compte des distances et des limitations de vitesse.

**Processus** :
1. Le routeur se place au centre de la carte (racine de l'arbre)
2. Il examine tous les liens possibles
3. Il choisit le lien avec le coÃ»t le plus faible
4. Il continue jusqu'Ã  avoir trouvÃ© le meilleur chemin vers chaque destination
5. Il construit un **arbre SPF** (Shortest Path First Tree)

**RÃ©sultat** : Une table de routage optimale.

## Le fonctionnement d'OSPF Ã©tape par Ã©tape

### Ã‰tape 1 : DÃ©couverte des voisins

Les routeurs OSPF envoient des **Hello packets** sur toutes leurs interfaces activÃ©es pour OSPF.

**Hello packets** :
- EnvoyÃ©s toutes les 10 secondes (par dÃ©faut sur Ethernet)
- Contiennent : Router ID, aire, masque, timers, voisins connus
- Adresse multicast : 224.0.0.5 (tous les routeurs OSPF)

**Formation du voisinage** :
```
Routeur A                    Routeur B
    |                            |
    |--- Hello (je suis A) ----->|
    |                            |
    |<---- Hello (je suis B) ----|
    |                            |
  "Je connais B"            "Je connais A"
```

**Conditions pour devenir voisins** :
- MÃªme aire OSPF
- MÃªme masque de sous-rÃ©seau
- MÃªmes timers Hello et Dead
- MÃªme type d'authentification
- Pas de conflit d'options

### Ã‰tape 2 : Ã‰tablissement d'adjacence

Tous les voisins ne deviennent pas forcÃ©ment **adjacents** (Ã©change complet de LSA).

**Ã‰tats du voisinage** :

1. **Down** : Aucune information reÃ§ue
2. **Init** : Hello reÃ§u du voisin
3. **2-Way** : Communication bidirectionnelle Ã©tablie
4. **ExStart** : NÃ©gociation du master/slave pour l'Ã©change
5. **Exchange** : Ã‰change des descriptions de LSDB
6. **Loading** : Demande et rÃ©ception des LSA manquants
7. **Full** : LSDB synchronisÃ©es, adjacence complÃ¨te

**Pourquoi ne pas Ãªtre adjacent avec tout le monde ?**

Sur un rÃ©seau avec N routeurs, des adjacences complÃ¨tes nÃ©cessiteraient NÃ—(N-1)/2 Ã©changes.

**Exemple** : 10 routeurs = 45 adjacences = beaucoup de trafic !

**Solution OSPF** : Ã‰lire un reprÃ©sentant (DR/BDR).

### Ã‰tape 3 : Ã‰lection DR et BDR (sur rÃ©seaux multi-accÃ¨s)

Sur un rÃ©seau avec plusieurs routeurs (comme Ethernet), OSPF Ã©lit :
- Un **DR (Designated Router)** : routeur dÃ©signÃ© principal
- Un **BDR (Backup Designated Router)** : routeur dÃ©signÃ© de secours

**RÃ´le** :
- Les autres routeurs forment une adjacence uniquement avec le DR et le BDR
- Le DR collecte les LSA et les redistribue
- RÃ©duit considÃ©rablement le trafic

**Analogie** : Au lieu que chaque Ã©lÃ¨ve d'une classe parle Ã  tous les autres (45 conversations pour 10 Ã©lÃ¨ves), tous parlent au dÃ©lÃ©guÃ© de classe (DR) qui centralise et redistribue les informations (9 conversations seulement).

```
RÃ©seau Ethernet avec 5 routeurs :

Sans DR/BDR :                Avec DR/BDR :
    R1                           R1
   /||\                           |
  / || \                          |
R2--R3--R4                    R2--DR--R4
  \ || /                          |
   \||/                           |
    R5                           R5
                                  |
10 adjacences !               BDR (secours)

Avec DR : 4 adjacences vers DR + 4 vers BDR = 8 (au lieu de 10)
```

**Ã‰lection** :
- BasÃ©e sur la **prioritÃ©** (0-255, par dÃ©faut 1)
- PrioritÃ© 0 = ne peut pas Ãªtre DR/BDR
- Si Ã©galitÃ© : plus haut Router ID gagne
- Le DR reste en place mÃªme si un routeur avec meilleure prioritÃ© arrive plus tard

### Ã‰tape 4 : Ã‰change de LSA

Une fois l'adjacence Ã©tablie, les routeurs Ã©changent leurs LSA.

**Types de LSA principaux** :

| Type | Nom | Description |
|------|-----|-------------|
| **Type 1** | Router LSA | Liens du routeur dans son aire |
| **Type 2** | Network LSA | GÃ©nÃ©rÃ© par le DR, dÃ©crit le rÃ©seau multi-accÃ¨s |
| **Type 3** | Summary LSA | Routes inter-aires (gÃ©nÃ©rÃ©es par ABR) |
| **Type 4** | ASBR Summary | Chemin vers un ASBR |
| **Type 5** | External LSA | Routes externes (redistribuÃ©es) |
| **Type 7** | NSSA External | Routes externes dans une NSSA |

**Pour les dÃ©butants** : Concentrez-vous sur les types 1, 2 et 3.

**Propagation des LSA** :
```
1. R1 gÃ©nÃ¨re un LSA
2. R1 envoie son LSA au DR
3. DR envoie le LSA Ã  tous les routeurs (224.0.0.5)
4. Chaque routeur stocke le LSA dans sa LSDB
5. Chaque routeur recalcule son arbre SPF
6. Nouvelles routes installÃ©es dans la table de routage
```

### Ã‰tape 5 : Calcul SPF et construction de la table de routage

Avec la LSDB complÃ¨te, chaque routeur exÃ©cute l'algorithme de Dijkstra.

**Exemple simplifiÃ©** :

```
Topologie :
    10      10      10
R1 ---- R2 ---- R3 ---- R4
  \                    /
   \50              50/
    +------> R5 <----+
```

**Calcul depuis R1 vers R4** :

Chemins possibles :
- R1 â†’ R2 â†’ R3 â†’ R4 : coÃ»t 10+10+10 = 30 âœ… (meilleur)
- R1 â†’ R5 â†’ R4 : coÃ»t 50+50 = 100

**RÃ©sultat** : R1 choisit le chemin via R2-R3 (coÃ»t 30).

## La mÃ©trique OSPF : le coÃ»t

### Calcul du coÃ»t

OSPF utilise le **coÃ»t** comme mÃ©trique, basÃ© sur la **bande passante** :

**Formule** :
```
CoÃ»t = Bande passante de rÃ©fÃ©rence / Bande passante de l'interface
```

**Bande passante de rÃ©fÃ©rence par dÃ©faut** : 100 Mbps (10^8 bits/s)

### Tableau des coÃ»ts par dÃ©faut

| Type de lien | Bande passante | CoÃ»t OSPF |
|--------------|----------------|-----------|
| Serial 64 kbps | 64 Kbps | 1562 |
| T1 (1.544 Mbps) | 1.544 Mbps | 64 |
| Ethernet | 10 Mbps | 10 |
| Fast Ethernet | 100 Mbps | 1 |
| Gigabit Ethernet | 1 Gbps | 1* |
| 10 Gigabit Ethernet | 10 Gbps | 1* |

**ProblÃ¨me** : Avec la bande passante de rÃ©fÃ©rence par dÃ©faut, tous les liens â‰¥ 100 Mbps ont un coÃ»t de 1 !

**Solution** : Augmenter la bande passante de rÃ©fÃ©rence :
```
router ospf 1
  auto-cost reference-bandwidth 10000  ! 10 Gbps en Mbps
```

Avec cette configuration :
- Fast Ethernet (100 Mbps) : coÃ»t 100
- Gigabit (1 Gbps) : coÃ»t 10
- 10 Gigabit (10 Gbps) : coÃ»t 1

### Exemple de calcul de chemin

```
Topologie :
         FastEthernet (coÃ»t 1)
    R1 ----------------------- R2
     |                          |
     | Serial T1 (coÃ»t 64)      | Gigabit (coÃ»t 1)
     |                          |
    R3 ----------------------- R4
         FastEthernet (coÃ»t 1)

RÃ©seau destination : derriÃ¨re R4
```

**Chemins possibles depuis R1** :

1. R1 â†’ R2 â†’ R4 : coÃ»t 1 + 1 = **2** âœ…
2. R1 â†’ R3 â†’ R4 : coÃ»t 64 + 1 = **65**

OSPF choisit le chemin via R2 (coÃ»t total : 2).

**Avantage sur RIP** : RIP aurait choisi les deux chemins Ã©galement (2 sauts chacun), sans considÃ©rer que l'un utilise un lien lent !

## HiÃ©rarchie OSPF : les aires

### Pourquoi des aires ?

Dans un trÃ¨s grand rÃ©seau :
- Chaque changement dÃ©clenche un recalcul SPF sur tous les routeurs
- Les LSDB deviennent Ã©normes
- Les calculs consomment beaucoup de CPU
- La convergence est lente

**Solution** : Diviser le rÃ©seau en **aires** (areas).

### Concept d'aire

Une **aire OSPF** est un groupe logique de routeurs et de rÃ©seaux.

**Analogie** : C'est comme organiser un pays en rÃ©gions :
- Chaque rÃ©gion connaÃ®t en dÃ©tail sa propre gÃ©ographie
- Les rÃ©gions connaissent les autres rÃ©gions de faÃ§on simplifiÃ©e
- Un changement dans une rÃ©gion n'affecte pas les dÃ©tails des autres rÃ©gions

### Area 0 : Le backbone

**RÃ¨gle fondamentale d'OSPF** : Toutes les aires doivent Ãªtre connectÃ©es Ã  l'**Area 0** (backbone area).

```
        Area 1
          |
    Area 0 (Backbone)
        /   \
    Area 2  Area 3
```

**Pourquoi** : L'Area 0 sert de "colonne vertÃ©brale" pour propager les routes entre aires.

**Si une aire n'est pas connectÃ©e Ã  Area 0** :
```
Area 0 --- Area 1
               |
            Area 2  â† ProblÃ¨me ! Pas de lien direct vers Area 0
```

**Solution** : Utiliser un **virtual link** (lien virtuel) traversant Area 1.

### Avantages de la hiÃ©rarchie

1. **LSDB rÃ©duite** : Chaque aire a sa propre LSDB
2. **Calculs SPF localisÃ©s** : Un changement dans Area 1 ne dÃ©clenche pas de SPF dans Area 2
3. **ScalabilitÃ©** : Peut gÃ©rer des milliers de routeurs
4. **RÃ©sumÃ© des routes** : Les ABR peuvent agrÃ©ger les routes inter-aires

**Exemple** :

```
Area 1 contient :
- 192.168.1.0/24
- 192.168.2.0/24
- 192.168.3.0/24
- 192.168.4.0/24

L'ABR peut annoncer Ã  Area 0 un seul rÃ©sumÃ© :
- 192.168.0.0/22 (au lieu de 4 routes)
```

## Les types de routeurs OSPF

### 1. Internal Router (Routeur interne)

Un routeur dont **toutes les interfaces** sont dans la **mÃªme aire**.

```
    Area 1
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   R1    â”‚  â† Internal Router
    â”‚ (Area 1)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CaractÃ©ristiques** :
- LSDB contient uniquement les LSA de son aire
- Calculs SPF limitÃ©s Ã  son aire
- Plus simple Ã  gÃ©rer

### 2. ABR (Area Border Router)

Un routeur avec des interfaces dans **plusieurs aires**, dont obligatoirement **Area 0**.

```
    Area 1
      |
    [ABR]  â† Interfaces dans Area 0 et Area 1
      |
    Area 0
```

**RÃ´les** :
- Maintient une LSDB sÃ©parÃ©e pour chaque aire
- GÃ©nÃ¨re des LSA de type 3 (Summary LSA)
- Fait le lien entre les aires
- Peut rÃ©sumer les routes

### 3. ASBR (Autonomous System Border Router)

Un routeur qui **redistribue** des routes d'autres protocoles (RIP, BGP, statiques) dans OSPF.

```
    OSPF              Autre AS
    Domain            (RIP, BGP, Static)
      |                   |
    [ASBR] â† Redistribue les routes
```

**RÃ´les** :
- GÃ©nÃ¨re des LSA de type 5 (External LSA)
- Injecte des routes externes dans OSPF
- Passerelle vers d'autres domaines de routage

### 4. Backbone Router

Un routeur avec **au moins une interface dans Area 0**.

```
    Area 0
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   R1    â”‚  â† Backbone Router
    â”‚ (Area 0)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Note** : Un ABR est toujours aussi un Backbone Router.

### Exemple complet

```
        [Internet/BGP]
              |
          [R1 - ASBR] â† Redistribue BGP dans OSPF
              |
        â”Œâ”€ Area 0 â”€â”€â”
        â”‚           â”‚
      [R2]        [R3 - ABR] â† Interfaces dans Area 0 et Area 1
                    â”‚
                â”Œ Area 1 â”
                â”‚        â”‚
              [R4]     [R5] â† Internal Routers
```

**Classification** :
- R1 : ASBR + Backbone Router
- R2 : Backbone Router (interne Ã  Area 0)
- R3 : ABR + Backbone Router
- R4, R5 : Internal Routers (Area 1)

## Les types de rÃ©seaux OSPF

OSPF se comporte diffÃ©remment selon le type de rÃ©seau.

### 1. Broadcast (ex: Ethernet)

**CaractÃ©ristiques** :
- Multi-accÃ¨s : plusieurs routeurs sur le mÃªme segment
- Support du broadcast/multicast
- **Ã‰lit un DR et un BDR**
- Hello interval : 10 secondes
- Dead interval : 40 secondes

### 2. Point-to-Point (ex: liaison sÃ©rie)

**CaractÃ©ristiques** :
- Connexion directe entre deux routeurs seulement
- **Pas de DR/BDR** (inutile avec 2 routeurs)
- Adjacence automatique
- Hello interval : 10 secondes
- Dead interval : 40 secondes

### 3. Non-Broadcast Multi-Access (NBMA)

**CaractÃ©ristiques** :
- Multi-accÃ¨s mais sans broadcast (ex: Frame Relay, X.25)
- **Ã‰lit un DR et un BDR**
- Configuration manuelle des voisins nÃ©cessaire
- Hello interval : 30 secondes
- Dead interval : 120 secondes

### 4. Point-to-Multipoint

**CaractÃ©ristiques** :
- TraitÃ© comme une collection de liens point-Ã -point
- **Pas de DR/BDR**
- Meilleure alternative Ã  NBMA
- Hello interval : 30 secondes
- Dead interval : 120 secondes

## Configuration OSPF (exemple conceptuel)

### Configuration basique

```
Sur un routeur Cisco :

router ospf 1                          ! Process ID (local uniquement)
  router-id 1.1.1.1                    ! ID unique du routeur
  network 192.168.1.0 0.0.0.255 area 0 ! Active OSPF sur interfaces
  network 10.0.0.0 0.0.0.3 area 1
```

**Explications** :
- `router ospf 1` : DÃ©marre le processus OSPF (1 est un numÃ©ro local)
- `router-id` : Identifiant unique du routeur dans OSPF
- `network` : SpÃ©cifie quelles interfaces participent Ã  OSPF et dans quelle aire
- `0.0.0.255` : Wildcard mask (inverse du masque de sous-rÃ©seau)

### Configuration d'aires multiples

```
Configuration d'un ABR :

router ospf 1
  router-id 2.2.2.2
  network 10.0.0.0 0.0.0.3 area 0      ! Interface vers Area 0
  network 192.168.0.0 0.0.255.255 area 1 ! Interfaces dans Area 1
```

### Configuration avec rÃ©sumÃ©

```
Sur un ABR :

router ospf 1
  area 1 range 192.168.0.0 255.255.252.0  ! RÃ©sume Area 1 vers Area 0
```

Au lieu d'annoncer :
- 192.168.0.0/24
- 192.168.1.0/24
- 192.168.2.0/24
- 192.168.3.0/24

L'ABR annonce une seule route rÃ©sumÃ©e : 192.168.0.0/22

### Configuration du coÃ»t

```
Modifier le coÃ»t d'une interface :

interface GigabitEthernet0/0
  ip ospf cost 50    ! Force le coÃ»t Ã  50 (au lieu du calcul automatique)
```

Ou modifier la rÃ©fÃ©rence globale :

```
router ospf 1
  auto-cost reference-bandwidth 10000  ! RÃ©fÃ©rence en Mbps
```

## Convergence OSPF

### RapiditÃ© de convergence

OSPF converge **beaucoup plus rapidement** que RIP :

| Ã‰vÃ©nement | RIP | OSPF |
|-----------|-----|------|
| DÃ©tection de panne | 180 secondes | 40 secondes (dead timer) |
| Propagation | Minutes (hop-by-hop) | Secondes (flooding) |
| Calcul | Simple addition | SPF (plus complexe) |
| **Convergence totale** | **3-7 minutes** | **Quelques secondes** |

### Processus de convergence

```
1. Lien R1-R2 tombe en panne
   â†“
2. R1 dÃ©tecte la panne (absence de Hello pendant 40s ou dÃ©tection de lien)
   â†“
3. R1 gÃ©nÃ¨re un nouveau LSA reflÃ©tant le changement
   â†“
4. R1 propage ce LSA Ã  tous les routeurs (flooding)
   â†“
5. Chaque routeur met Ã  jour sa LSDB
   â†“
6. Chaque routeur recalcule son arbre SPF
   â†“
7. Nouvelles routes installÃ©es dans la table de routage
   â†“
8. Convergence complÃ¨te (typiquement 2-5 secondes)
```

### Techniques d'optimisation

**1. Incremental SPF** : Ne recalcule que les parties affectÃ©es de l'arbre

**2. LSA Throttling** : Limite la frÃ©quence de gÃ©nÃ©ration de LSA

**3. SPF Throttling** : Ã‰vite de recalculer SPF trop frÃ©quemment

**4. Fast Hello** : RÃ©duit les timers Hello (ex: 1 seconde)

## Avantages d'OSPF

### 1. Convergence rapide
- DÃ©tection rapide des pannes (secondes)
- Propagation immÃ©diate des changements
- Recalcul automatique des routes

### 2. ScalabilitÃ© excellente
- HiÃ©rarchie avec aires
- LSDB segmentÃ©es
- AgrÃ©gation de routes possible
- Peut gÃ©rer des milliers de routeurs

### 3. MÃ©trique intelligente
- BasÃ©e sur la bande passante
- ReflÃ¨te la capacitÃ© rÃ©elle des liens
- Choix optimaux des chemins

### 4. Pas de limite de distance
- Aucune restriction comme les 15 sauts de RIP
- AdaptÃ© aux trÃ¨s grands rÃ©seaux
- UtilisÃ© dans les backbones Internet

### 5. Support de VLSM et CIDR
- Supporte les masques de longueur variable
- AgrÃ©gation de routes
- Utilisation efficace de l'espace d'adressage

### 6. Pas de boucles de routage
- L'algorithme de Dijkstra garantit l'absence de boucles
- Vision complÃ¨te de la topologie
- Calculs mathÃ©matiquement corrects

### 7. Utilisation efficace de la bande passante
- Mises Ã  jour uniquement lors de changements
- Pas de mises Ã  jour pÃ©riodiques complÃ¨tes
- Multicast pour les mises Ã  jour

### 8. Authentification
- Support MD5 (OSPFv2)
- Support IPsec (OSPFv3)
- PrÃ©vient l'injection de fausses routes

### 9. ECMP (Equal-Cost Multi-Path)
- Ã‰quilibrage de charge sur plusieurs chemins de mÃªme coÃ»t
- Utilisation optimale de la bande passante
- Redondance automatique

### 10. Standard ouvert
- RFC publiques
- SupportÃ© par tous les fabricants
- InteropÃ©rabilitÃ© garantie

## InconvÃ©nients d'OSPF

### 1. ComplexitÃ©
- Configuration plus technique que RIP
- Nombreux concepts Ã  maÃ®triser (aires, LSA, DR/BDR, etc.)
- DÃ©pannage plus difficile
- Courbe d'apprentissage importante

### 2. Consommation de ressources
- Calculs SPF intensifs en CPU
- LSDB peut Ãªtre volumineuse (plusieurs Mo de RAM)
- Plus exigeant que RIP sur le matÃ©riel

**Exemple** : Un routeur avec 1000 routes OSPF peut nÃ©cessiter :
- 50-100 Mo de RAM pour la LSDB
- Pics de CPU lors des recalculs SPF

### 3. Conception nÃ©cessaire
- NÃ©cessite une planification des aires
- Mauvaise conception = performance dÃ©gradÃ©e
- Difficile Ã  corriger aprÃ¨s dÃ©ploiement

### 4. SensibilitÃ© Ã  l'instabilitÃ©
- Un lien instable (flapping) peut causer de nombreux recalculs SPF
- Impact sur tous les routeurs de l'aire
- NÃ©cessite des mÃ©canismes de dampening

### 5. Toutes les aires doivent toucher Area 0
- Contrainte architecturale
- Peut nÃ©cessiter des virtual links (complexes)
- Moins flexible que d'autres protocoles

## Comparaison RIP vs OSPF

| CritÃ¨re | RIP | OSPF |
|---------|-----|------|
| **Type** | Vecteur de distance | Ã‰tat de lien |
| **MÃ©trique** | Sauts | CoÃ»t (bande passante) |
| **MÃ©trique max** | 15 | IllimitÃ© |
| **Convergence** | Lente (minutes) | Rapide (secondes) |
| **ScalabilitÃ©** | Faible (<10 routeurs) | Excellente (milliers) |
| **HiÃ©rarchie** | Non | Oui (aires) |
| **VLSM/CIDR** | RIPv2 : Oui | Oui |
| **Boucles** | Possible | Impossible |
| **ComplexitÃ©** | Faible | Ã‰levÃ©e |
| **CPU/MÃ©moire** | Faible | Moyenne Ã  Ã©levÃ©e |
| **Bande passante** | Ã‰levÃ©e (pÃ©riodique) | Faible (Ã©vÃ©nements) |
| **Standard** | RFC 2453 | RFC 2328 |
| **Utilisation** | Petits rÃ©seaux | RÃ©seaux d'entreprise |

## Quand utiliser OSPF ?

### âœ… Cas d'usage idÃ©aux

1. **RÃ©seaux d'entreprise moyens Ã  grands**
   - 10 Ã  10 000+ routeurs
   - Topologie complexe
   - Besoins de redondance

2. **Exigences de haute disponibilitÃ©**
   - Applications critiques
   - Convergence rapide nÃ©cessaire
   - Downtime minimal acceptable

3. **Infrastructure campus**
   - Multiples bÃ¢timents
   - Nombreux VLANs
   - HiÃ©rarchie d'accÃ¨s/distribution/cÅ“ur

4. **Backbones de FAI**
   - Grandes infrastructures
   - NÃ©cessitÃ© de scalabilitÃ©
   - AgrÃ©gation de routes

5. **Datacenters**
   - Topologies leaf-spine
   - Chemins multiples
   - ECMP pour load balancing

6. **RÃ©seaux avec liens hÃ©tÃ©rogÃ¨nes**
   - Mix de connexions rapides et lentes
   - Besoin d'optimisation de bande passante
   - MÃ©trique de coÃ»t importante

### âŒ Cas oÃ¹ OSPF peut Ãªtre surdimensionnÃ©

1. **TrÃ¨s petits rÃ©seaux**
   - Moins de 5 routeurs
   - Topologie simple
   - RIP ou statique suffisent

2. **Ã‰quipements limitÃ©s**
   - Routeurs avec peu de RAM/CPU
   - Ã‰quipements anciens
   - Budget contraint

3. **Ã‰quipe sans expertise OSPF**
   - Pas de formation disponible
   - Besoin de solution simple
   - Support limitÃ©

## Exemple de rÃ©seau OSPF complet

```
                    [Internet]
                        |
                  [R1 - ASBR]
                  (Router-ID: 1.1.1.1)
                        |
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€ Area 0 (Backbone) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        |               |                    |
    [R2]            [R3]                 [R4 - ABR]
(2.2.2.2)        (3.3.3.3)            (4.4.4.4)
        |                                    |
    [Switch]                          â”Œâ”€ Area 1 â”€â”€â”
        |                             |           |
   [LAN Siege]                     [R5]         [R6]
192.168.1.0/24                   (5.5.5.5)    (6.6.6.6)
                                    |            |
                              [LAN Branch1]   [LAN Branch2]
                              192.168.10.0/24 192.168.20.0/24
```

**Configuration R1 (ASBR)** :
```
router ospf 1
  router-id 1.1.1.1
  network 10.0.0.0 0.0.0.255 area 0
  default-information originate    ! Propage route par dÃ©faut
```

**Configuration R4 (ABR)** :
```
router ospf 1
  router-id 4.4.4.4
  network 10.0.1.0 0.0.0.255 area 0
  network 192.168.0.0 0.0.255.255 area 1
  area 1 range 192.168.0.0 255.255.240.0  ! RÃ©sume Area 1
```

**Configuration R5 (Internal)** :
```
router ospf 1
  router-id 5.5.5.5
  network 192.168.10.0 0.0.0.255 area 1
  network 10.0.2.0 0.0.0.255 area 1
```

**RÃ©sultat** :
- Area 0 contient R1, R2, R3, R4
- Area 1 contient R4 (aussi dans Area 0), R5, R6
- R4 (ABR) rÃ©sume les routes de Area 1 vers Area 0
- R1 (ASBR) injecte la route par dÃ©faut vers Internet
- Convergence rapide en cas de panne
- Chemins optimisÃ©s selon la bande passante

## Points clÃ©s Ã  retenir

1. **OSPF est un protocole Ã  Ã©tat de lien** : chaque routeur a une carte complÃ¨te du rÃ©seau
2. **LSA et LSDB** : Les routeurs Ã©changent des LSA et construisent une base de donnÃ©es identique
3. **Algorithme de Dijkstra** : Calcule le chemin le plus court vers chaque destination
4. **MÃ©trique basÃ©e sur le coÃ»t** : ReflÃ¨te la bande passante des liens
5. **HiÃ©rarchie avec aires** : Permet la scalabilitÃ©, Area 0 est obligatoire
6. **Types de routeurs** : Internal, ABR, ASBR, Backbone
7. **DR/BDR** : RÃ©duit le trafic sur les rÃ©seaux multi-accÃ¨s
8. **Convergence rapide** : Quelques secondes vs minutes pour RIP
9. **Pas de limite de distance** : AdaptÃ© aux trÃ¨s grands rÃ©seaux
10. **Plus complexe que RIP** : NÃ©cessite formation et planification

## Ce qui vient ensuite

Dans la section suivante (**3.12.4**), nous dÃ©couvrirons **BGP (Border Gateway Protocol)**, le protocole qui fait vraiment fonctionner Internet :
- Routage entre systÃ¨mes autonomes (AS)
- Protocole utilisÃ© par les FAI
- Gestion de centaines de milliers de routes
- Prise en compte de politiques de routage complexes

BGP est le protocole le plus complexe, mais aussi le plus important d'Internet. Comprendre OSPF est une excellente prÃ©paration pour aborder BGP !

---

**Conseil pratique** : OSPF est le standard de facto pour les rÃ©seaux d'entreprise. Investir du temps pour le maÃ®triser est extrÃªmement rentable pour une carriÃ¨re dans les rÃ©seaux. Commencez par des configurations simples (area 0 uniquement), puis progressez vers des architectures multi-aires. L'utilisation d'outils de simulation comme Packet Tracer ou GNS3 est fortement recommandÃ©e pour visualiser le fonctionnement d'OSPF en temps rÃ©el !

â­ï¸ [BGP : le protocole d'Internet](/03-couche-internet/12.4-bgp.md)
