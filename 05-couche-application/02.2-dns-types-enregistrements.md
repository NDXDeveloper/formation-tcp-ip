ğŸ” Retour au [Sommaire](/SOMMAIRE.md)

# 5.2.2 Types d'enregistrements DNS

## Introduction

Si DNS Ã©tait une base de donnÃ©es, les enregistrements (ou **resource records**, abrÃ©gÃ©s **RR**) seraient les diffÃ©rents types de donnÃ©es qu'elle peut stocker. Chaque type d'enregistrement a un **rÃ´le spÃ©cifique** et une **structure particuliÃ¨re**. Comprendre ces enregistrements est essentiel pour configurer correctement un domaine, diagnostiquer des problÃ¨mes DNS, ou optimiser les performances.

Dans cette section, nous allons explorer en dÃ©tail les types d'enregistrements les plus courants et les plus importants, avec des exemples concrets d'utilisation.

## Format gÃ©nÃ©ral d'un enregistrement DNS

Avant d'explorer chaque type, comprenons la structure commune Ã  tous les enregistrements :

```
nom    TTL  classe  type  donnÃ©es

Exemple :
www.example.com.  3600  IN  A  93.184.216.34
â”‚                 â”‚     â”‚   â”‚  â”‚
â”‚                 â”‚     â”‚   â”‚  â””â”€ DonnÃ©es (valeur de l'enregistrement)
â”‚                 â”‚     â”‚   â””â”€â”€â”€â”€ Type d'enregistrement
â”‚                 â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€ Classe (presque toujours IN = Internet)
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TTL (Time To Live, en secondes)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Nom de domaine (FQDN)
```

**Champs expliquÃ©s :**

| Champ | Description | Exemple |
|-------|-------------|---------|
| **Nom** | FQDN ou @ (pour la racine de zone) | `www.example.com.` ou `@` |
| **TTL** | DurÃ©e de vie en cache (secondes) | `3600` (1 heure) |
| **Classe** | Presque toujours `IN` (Internet) | `IN` |
| **Type** | Type d'enregistrement | `A`, `AAAA`, `CNAME`, etc. |
| **DonnÃ©es** | Valeur selon le type | Adresse IP, nom, texte... |

## A - Address Record (IPv4)

### Description

L'enregistrement **A** (Address) associe un nom de domaine Ã  une **adresse IPv4**.

C'est le type d'enregistrement le plus fondamental et le plus utilisÃ©.

### Format

```
nom    TTL  IN  A  adresse_ipv4
```

### Exemples

```dns
; Enregistrements A simples
example.com.        3600  IN  A  93.184.216.34
www.example.com.    3600  IN  A  93.184.216.34
blog.example.com.   1800  IN  A  93.184.216.50
mail.example.com.   3600  IN  A  93.184.216.60

; Plusieurs enregistrements A pour le mÃªme nom (load balancing DNS)
www.example.com.    300   IN  A  93.184.216.34
www.example.com.    300   IN  A  93.184.216.35
www.example.com.    300   IN  A  93.184.216.36
```

### Cas d'usage

**1. Site web principal**
```dns
example.com.     IN  A  93.184.216.34
www.example.com. IN  A  93.184.216.34
```
Les visiteurs peuvent accÃ©der via `example.com` ou `www.example.com`.

**2. Services distincts**
```dns
blog.example.com.     IN  A  93.184.216.50   (serveur blog)
shop.example.com.     IN  A  93.184.216.60   (serveur e-commerce)
api.example.com.      IN  A  93.184.216.70   (serveur API)
```

**3. Load balancing DNS (round-robin)**
```dns
www.example.com.  IN  A  192.0.2.1
www.example.com.  IN  A  192.0.2.2
www.example.com.  IN  A  192.0.2.3
```

Le rÃ©solveur DNS retourne les adresses dans un ordre diffÃ©rent Ã  chaque requÃªte (rotation), distribuant ainsi la charge entre plusieurs serveurs.

**Limitation :** Cette mÃ©thode est basique et ne tient pas compte de la charge rÃ©elle ou de la disponibilitÃ© des serveurs.

### RequÃªte et rÃ©ponse

```bash
$ dig example.com A

; <<>> DiG 9.18.24 <<>> example.com A
;; QUESTION SECTION:
;example.com.                   IN      A

;; ANSWER SECTION:
example.com.            3600    IN      A       93.184.216.34

;; Query time: 15 msec
```

### Points importants

- âœ… Un nom peut avoir plusieurs enregistrements A
- âœ… TTL court (300s) pour Ã©quilibrage de charge
- âœ… TTL long (3600s+) pour stabilitÃ©
- âš ï¸ Si IPv6 disponible, ajouter aussi un enregistrement AAAA

## AAAA - IPv6 Address Record

### Description

L'enregistrement **AAAA** (quad-A) associe un nom de domaine Ã  une **adresse IPv6**.

Le nom "AAAA" vient du fait qu'une adresse IPv6 fait 128 bits (4 fois plus qu'IPv4 = 32 bits).

### Format

```
nom    TTL  IN  AAAA  adresse_ipv6
```

### Exemples

```dns
; Enregistrements AAAA simples
example.com.        3600  IN  AAAA  2606:2800:220:1:248:1893:25c8:1946
www.example.com.    3600  IN  AAAA  2606:2800:220:1:248:1893:25c8:1946

; Notation IPv6 compressÃ©e
blog.example.com.   3600  IN  AAAA  2001:db8::1
mail.example.com.   3600  IN  AAAA  2001:db8::2

; Dual-stack (IPv4 + IPv6)
www.example.com.    3600  IN  A     93.184.216.34
www.example.com.    3600  IN  AAAA  2606:2800:220:1:248:1893:25c8:1946
```

### Cas d'usage

**Dual-stack moderne (recommandÃ©)**
```dns
; Configuration complÃ¨te IPv4/IPv6
example.com.     3600  IN  A     93.184.216.34
example.com.     3600  IN  AAAA  2606:2800:220::1

www.example.com. 3600  IN  A     93.184.216.34
www.example.com. 3600  IN  AAAA  2606:2800:220::1
```

Les clients compatibles IPv6 utiliseront l'adresse IPv6, les autres utiliseront IPv4.

### Ordre de prÃ©fÃ©rence

Les systÃ¨mes d'exploitation modernes **prÃ©fÃ¨rent IPv6** si disponible :

```
Client avec IPv6 interroge www.example.com :
1. ReÃ§oit A et AAAA
2. PrÃ©fÃ¨re AAAA (IPv6)
3. Se connecte via IPv6

Client sans IPv6 interroge www.example.com :
1. ReÃ§oit A et AAAA
2. Ne peut pas utiliser AAAA
3. Se connecte via IPv4 (fallback)
```

### RequÃªte et rÃ©ponse

```bash
$ dig example.com AAAA

; <<>> DiG 9.18.24 <<>> example.com AAAA
;; QUESTION SECTION:
;example.com.                   IN      AAAA

;; ANSWER SECTION:
example.com.            3600    IN      AAAA    2606:2800:220:1:248:1893:25c8:1946

;; Query time: 18 msec
```

### Points importants

- âœ… Toujours fournir A et AAAA pour compatibilitÃ© maximale
- âœ… IPv6 sera prÃ©fÃ©rÃ© si disponible
- âœ… TTL identique pour A et AAAA recommandÃ©
- ğŸ“Š Adoption IPv6 en constante augmentation

## CNAME - Canonical Name Record

### Description

L'enregistrement **CNAME** (Canonical Name) crÃ©e un **alias** d'un nom vers un autre nom. C'est une redirection au niveau DNS.

### Format

```
alias    TTL  IN  CNAME  nom_canonique
```

### Exemples

```dns
; CNAME simples
www.example.com.        3600  IN  CNAME  example.com.
blog.example.com.       3600  IN  CNAME  example.com.
ftp.example.com.        3600  IN  CNAME  files.example.com.

; CNAME vers un service externe
shop.example.com.       3600  IN  CNAME  myshop.shopify.com.
docs.example.com.       3600  IN  CNAME  example.github.io.
cdn.example.com.        3600  IN  CNAME  d111111abcdef8.cloudfront.net.
```

### Cas d'usage

**1. Simplifier la gestion**
```dns
; Configuration centralisÃ©e
example.com.     IN  A     93.184.216.34
www.example.com. IN  CNAME example.com.
blog.example.com. IN  CNAME example.com.

; Changement d'IP : 1 seule modification nÃ©cessaire !
```

**2. Services externes (CDN, hÃ©bergement)**
```dns
; Site hÃ©bergÃ© sur Netlify
www.example.com.  IN  CNAME  example.netlify.app.

; Site hÃ©bergÃ© sur GitHub Pages
docs.example.com. IN  CNAME  username.github.io.

; CDN Cloudflare
cdn.example.com.  IN  CNAME  example.com.cdn.cloudflare.net.
```

**3. Environnements multiples**
```dns
prod.example.com.    IN  CNAME  server1.datacenter.net.
staging.example.com. IN  CNAME  server2.datacenter.net.
dev.example.com.     IN  CNAME  server3.datacenter.net.
```

### Processus de rÃ©solution avec CNAME

```
Client demande : www.example.com

Ã‰tape 1 : RÃ©solveur interroge DNS
â””â”€ RÃ©ponse : www.example.com â†’ CNAME â†’ example.com

Ã‰tape 2 : RÃ©solveur interroge Ã  nouveau pour example.com
â””â”€ RÃ©ponse : example.com â†’ A â†’ 93.184.216.34

RÃ©sultat final : www.example.com = 93.184.216.34

C'est transparent pour l'utilisateur, mais nÃ©cessite 2 requÃªtes !
```

### Restrictions importantes

**âŒ Interdictions CNAME**

1. **Pas de CNAME Ã  la racine de zone**
```dns
; INTERDIT
example.com.  IN  CNAME  other.com.

; La racine de zone DOIT avoir SOA et NS
; Un CNAME empÃªcherait ces enregistrements
```

Solution : Utiliser ALIAS/ANAME (non standard) ou plusieurs enregistrements A.

2. **Pas d'autres enregistrements avec un CNAME**
```dns
; INTERDIT
www.example.com.  IN  CNAME  example.com.
www.example.com.  IN  A      93.184.216.34  â† Conflit !

; Un nom ne peut avoir qu'un CNAME, rien d'autre
```

3. **Pas de CNAME vers un CNAME**
```dns
; DÃ‰CONSEILLÃ‰ (mais parfois tolÃ©rÃ©)
www.example.com.    IN  CNAME  web.example.com.
web.example.com.    IN  CNAME  server.example.com.
server.example.com. IN  A      93.184.216.34

; CrÃ©e une chaÃ®ne nÃ©cessitant 3 requÃªtes DNS
; Impact performance et complexitÃ©
```

### CNAME vs A : Quel choix ?

| CritÃ¨re | CNAME | A |
|---------|-------|---|
| **FlexibilitÃ©** | âœ… Changement centralisÃ© | âŒ Doit modifier partout |
| **Performance** | âš ï¸ RequÃªte supplÃ©mentaire | âœ… RÃ©ponse directe |
| **Racine de zone** | âŒ Interdit | âœ… AutorisÃ© |
| **Services externes** | âœ… IdÃ©al (suit les changements) | âš ï¸ Doit mettre Ã  jour manuellement |
| **Load balancing** | âŒ Difficile | âœ… Facile (plusieurs A) |

### RequÃªte et rÃ©ponse

```bash
$ dig www.example.com

; <<>> DiG 9.18.24 <<>> www.example.com
;; QUESTION SECTION:
;www.example.com.               IN      A

;; ANSWER SECTION:
www.example.com.        3600    IN      CNAME   example.com.
example.com.            3600    IN      A       93.184.216.34

;; Query time: 25 msec
```

## MX - Mail Exchange Record

### Description

L'enregistrement **MX** (Mail Exchange) indique les **serveurs de messagerie** responsables de recevoir les emails pour un domaine.

### Format

```
domaine    TTL  IN  MX  prioritÃ©  serveur_mail
```

La **prioritÃ©** (de 0 Ã  65535) dÃ©termine l'ordre de tentative : **plus le nombre est bas, plus la prioritÃ© est haute**.

### Exemples

```dns
; Configuration MX simple
example.com.  3600  IN  MX  10  mail.example.com.
mail.example.com. 3600 IN  A   93.184.216.50

; Configuration MX avec backup
example.com.  3600  IN  MX  10  mail1.example.com.
example.com.  3600  IN  MX  20  mail2.example.com.
example.com.  3600  IN  MX  30  mail3.example.com.

; Configuration avec serveurs externes (Google Workspace)
example.com.  3600  IN  MX  1   aspmx.l.google.com.
example.com.  3600  IN  MX  5   alt1.aspmx.l.google.com.
example.com.  3600  IN  MX  5   alt2.aspmx.l.google.com.
example.com.  3600  IN  MX  10  alt3.aspmx.l.google.com.
example.com.  3600  IN  MX  10  alt4.aspmx.l.google.com.

; Configuration Microsoft 365
example.com.  3600  IN  MX  0   example-com.mail.protection.outlook.com.
```

### Fonctionnement des prioritÃ©s

```
Serveur expÃ©diteur veut envoyer Ã  user@example.com :

1. RequÃªte DNS MX pour example.com
   RÃ©sultat :
   â”œâ”€ PrioritÃ© 10 : mail1.example.com
   â”œâ”€ PrioritÃ© 20 : mail2.example.com
   â””â”€ PrioritÃ© 30 : mail3.example.com

2. Tri par prioritÃ© (ordre croissant)

3. Tentative de connexion :
   a) Essaie mail1.example.com (prioritÃ© 10)
      â””â”€ Si succÃ¨s : Email envoyÃ© âœ“
      â””â”€ Si Ã©chec : Passe au suivant

   b) Essaie mail2.example.com (prioritÃ© 20)
      â””â”€ Si succÃ¨s : Email envoyÃ© âœ“
      â””â”€ Si Ã©chec : Passe au suivant

   c) Essaie mail3.example.com (prioritÃ© 30)
      â””â”€ Si succÃ¨s : Email envoyÃ© âœ“
      â””â”€ Si Ã©chec : Ã‰chec dÃ©finitif âœ—

Les serveurs de mÃªme prioritÃ© sont sÃ©lectionnÃ©s alÃ©atoirement
(Ã©quilibrage de charge)
```

### Cas d'usage

**1. Serveur principal + backup**
```dns
example.com.  IN  MX  10  mail.example.com.      (primaire)
example.com.  IN  MX  20  backup-mail.example.com. (backup)
```

**2. Ã‰quilibrage de charge**
```dns
example.com.  IN  MX  10  mail1.example.com.
example.com.  IN  MX  10  mail2.example.com.
example.com.  IN  MX  10  mail3.example.com.

Les 3 serveurs ont la mÃªme prioritÃ©
â†’ SÃ©lection alÃ©atoire â†’ Distribution de charge
```

**3. Services de messagerie externes**
```dns
; Google Workspace
example.com.  IN  MX  1   aspmx.l.google.com.
example.com.  IN  MX  5   alt1.aspmx.l.google.com.
example.com.  IN  MX  5   alt2.aspmx.l.google.com.

; ProtonMail
example.com.  IN  MX  10  mail.protonmail.ch.
example.com.  IN  MX  20  mailsec.protonmail.ch.
```

### Configuration complÃ¨te avec anti-spam

```dns
; Enregistrements MX
example.com.  IN  MX  10  mail.example.com.

; Serveur de mail
mail.example.com.  IN  A  93.184.216.50

; SPF (Sender Policy Framework)
example.com.  IN  TXT  "v=spf1 mx ip4:93.184.216.50 ~all"

; DKIM (DomainKeys Identified Mail)
default._domainkey.example.com. IN TXT "v=DKIM1; k=rsa; p=MIGfMA0GCS..."

; DMARC (Domain-based Message Authentication)
_dmarc.example.com.  IN  TXT  "v=DMARC1; p=quarantine; rua=mailto:dmarc@example.com"
```

### Erreurs courantes

**âŒ MX pointant vers CNAME**
```dns
; INTERDIT
example.com.     IN  MX  10  mail.example.com.
mail.example.com. IN  CNAME  server.hosting.com.

; Les MX NE DOIVENT PAS pointer vers des CNAME
; Pointez directement vers un enregistrement A/AAAA
```

**âŒ MX pointant vers une adresse IP**
```dns
; INTERDIT
example.com.  IN  MX  10  93.184.216.50

; MX doit pointer vers un nom de domaine, pas une IP
```

**âœ… Configuration correcte**
```dns
example.com.      IN  MX  10  mail.example.com.
mail.example.com. IN  A       93.184.216.50
```

### RequÃªte et rÃ©ponse

```bash
$ dig example.com MX

; <<>> DiG 9.18.24 <<>> example.com MX
;; QUESTION SECTION:
;example.com.                   IN      MX

;; ANSWER SECTION:
example.com.            3600    IN      MX      1 aspmx.l.google.com.
example.com.            3600    IN      MX      5 alt1.aspmx.l.google.com.
example.com.            3600    IN      MX      5 alt2.aspmx.l.google.com.

;; Query time: 22 msec
```

## NS - Name Server Record

### Description

L'enregistrement **NS** (Name Server) indique les **serveurs DNS autoritaires** pour une zone ou sous-zone.

### Format

```
zone    TTL  IN  NS  nom_serveur_dns
```

### Exemples

```dns
; Serveurs NS pour example.com
example.com.  172800  IN  NS  ns1.example.com.
example.com.  172800  IN  NS  ns2.example.com.
example.com.  172800  IN  NS  ns3.example.com.

; Avec les adresses correspondantes (glue records)
ns1.example.com.  172800  IN  A  203.0.113.10
ns2.example.com.  172800  IN  A  203.0.113.11
ns3.example.com.  172800  IN  A  198.51.100.10

; DÃ©lÃ©gation de sous-zone
france.example.com.  172800  IN  NS  ns1.france.example.com.
france.example.com.  172800  IN  NS  ns2.france.example.com.
ns1.france.example.com. 172800 IN  A  198.51.100.20
ns2.france.example.com. 172800 IN  A  198.51.100.21
```

### Cas d'usage

**1. Serveurs DNS pour le domaine principal**
```dns
example.com.  IN  NS  ns1.provider.com.
example.com.  IN  NS  ns2.provider.com.
example.com.  IN  NS  ns3.provider.com.
```

**2. DÃ©lÃ©gation de sous-domaine**
```dns
; DÃ©lÃ©guer blog.example.com Ã  des serveurs diffÃ©rents
blog.example.com.  IN  NS  ns1.bloghost.com.
blog.example.com.  IN  NS  ns2.bloghost.com.
```

**3. Configuration gÃ©o-distribuÃ©e**
```dns
example.com.  IN  NS  ns-europe.example.com.
example.com.  IN  NS  ns-america.example.com.
example.com.  IN  NS  ns-asia.example.com.
```

### Glue records nÃ©cessaires

Quand les serveurs NS sont **dans le domaine** qu'ils servent :

```dns
; PROBLÃˆME : Chicken and egg
example.com.  IN  NS  ns1.example.com.

"Pour trouver ns1.example.com, je dois interroger les NS de example.com,
 qui sont... ns1.example.com !"

; SOLUTION : Glue records
example.com.      IN  NS  ns1.example.com.
ns1.example.com.  IN  A   203.0.113.10  â† Glue record fourni par le parent
```

### RequÃªte et rÃ©ponse

```bash
$ dig example.com NS

; <<>> DiG 9.18.24 <<>> example.com NS
;; QUESTION SECTION:
;example.com.                   IN      NS

;; ANSWER SECTION:
example.com.            172800  IN      NS      a.iana-servers.net.
example.com.            172800  IN      NS      b.iana-servers.net.

;; ADDITIONAL SECTION:
a.iana-servers.net.     172800  IN      A       199.43.135.53
b.iana-servers.net.     172800  IN      A       199.43.133.53

;; Query time: 28 msec
```

## TXT - Text Record

### Description

L'enregistrement **TXT** contient du **texte arbitraire**. Initialement prÃ©vu pour des commentaires, il est maintenant massivement utilisÃ© pour diverses vÃ©rifications et configurations.

### Format

```
nom    TTL  IN  TXT  "chaÃ®ne de texte"
```

### Exemples de base

```dns
; Texte simple
example.com.  IN  TXT  "Ceci est un commentaire"

; Plusieurs enregistrements TXT
example.com.  IN  TXT  "v=spf1 mx ~all"
example.com.  IN  TXT  "google-site-verification=abc123..."
example.com.  IN  TXT  "Contact: admin@example.com"
```

### Cas d'usage modernes

#### 1. SPF (Sender Policy Framework) - Anti-spam

DÃ©finit quels serveurs sont autorisÃ©s Ã  envoyer des emails pour le domaine :

```dns
example.com.  IN  TXT  "v=spf1 mx ip4:93.184.216.50 include:_spf.google.com ~all"
                       â”‚      â”‚  â”‚                  â”‚                          â”‚
                       â”‚      â”‚  â”‚                  â”‚                          â””â”€ ~all = soft fail
                       â”‚      â”‚  â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Inclure Google
                       â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ IP autorisÃ©e
                       â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Serveurs MX autorisÃ©s
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Version SPF
```

**MÃ©canismes SPF :**
```dns
v=spf1          Version SPF 1
mx              Autoriser les serveurs MX
a               Autoriser l'enregistrement A du domaine
ip4:1.2.3.4     Autoriser cette IPv4
ip6:2001::/64   Autoriser ce rÃ©seau IPv6
include:domain  Inclure la politique SPF d'un autre domaine
~all            Soft fail (suspect)
-all            Hard fail (rejet)
+all            Accept all (dÃ©conseillÃ© !)
```

#### 2. DKIM (DomainKeys Identified Mail) - Signature numÃ©rique

ClÃ© publique pour vÃ©rifier les signatures des emails :

```dns
default._domainkey.example.com. IN TXT "v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC..."
        â”‚                              â”‚      â”‚     â”‚
        â”‚                              â”‚      â”‚     â””â”€ ClÃ© publique RSA (base64)
        â”‚                              â”‚      â””â”€â”€â”€â”€â”€â”€â”€ Type de clÃ© (RSA)
        â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Version DKIM
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SÃ©lecteur (peut varier)
```

#### 3. DMARC (Domain-based Message Authentication)

Politique de traitement des emails non authentifiÃ©s :

```dns
_dmarc.example.com. IN TXT "v=DMARC1; p=quarantine; rua=mailto:dmarc-reports@example.com; pct=100"
       â”‚                   â”‚          â”‚            â”‚                                      â”‚
       â”‚                   â”‚          â”‚            â”‚                                      â””â”€ Pourcentage (100%)
       â”‚                   â”‚          â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Email pour rapports
       â”‚                   â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Politique (quarantine)
       â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Version DMARC
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PrÃ©fixe DMARC

Politiques DMARC :
p=none         Surveillance uniquement (rapports)
p=quarantine   Mettre en quarantaine (spam)
p=reject       Rejeter complÃ¨tement
```

#### 4. VÃ©rification de propriÃ©tÃ© de domaine

```dns
; Google Search Console
example.com. IN TXT "google-site-verification=1234567890abcdef"

; Microsoft 365
example.com. IN TXT "MS=ms12345678"

; Facebook Domain Verification
example.com. IN TXT "facebook-domain-verification=abcdef123456"

; Apple Domain Verification
example.com. IN TXT "apple-domain-verification=xyz123"
```

#### 5. Informations de sÃ©curitÃ© et contact

```dns
; Security.txt (oÃ¹ trouver la politique de sÃ©curitÃ©)
_security.example.com. IN TXT "security_contact=https://example.com/.well-known/security.txt"

; Contact d'abuse
example.com. IN TXT "abuse-mailbox=abuse@example.com"
```

### Limitations

**Longueur maximale :**
- Une chaÃ®ne : 255 caractÃ¨res
- Enregistrement total : 512 octets (en pratique)

**Pour de longs textes :**
```dns
; DÃ©coupage en plusieurs chaÃ®nes (concatÃ©nÃ©es automatiquement)
example.com. IN TXT "v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC" "resto_de_la_cle_tres_longue..."
```

### RequÃªte et rÃ©ponse

```bash
$ dig example.com TXT

; <<>> DiG 9.18.24 <<>> example.com TXT
;; QUESTION SECTION:
;example.com.                   IN      TXT

;; ANSWER SECTION:
example.com.            3600    IN      TXT     "v=spf1 mx ~all"
example.com.            3600    IN      TXT     "google-site-verification=abc123..."

;; Query time: 19 msec
```

## PTR - Pointer Record (RÃ©solution inverse)

### Description

L'enregistrement **PTR** (Pointer) fait le mapping **inverse** : d'une **adresse IP vers un nom de domaine**.

### Format

```
adresse_ip_inversÃ©e.in-addr.arpa.    TTL  IN  PTR  nom_domaine
```

### Transformation de l'adresse IP

**Pour IPv4 :**
```
Adresse IP : 93.184.216.34

Ã‰tapes :
1. Inverser les octets : 34.216.184.93
2. Ajouter .in-addr.arpa : 34.216.184.93.in-addr.arpa.

Enregistrement PTR :
34.216.184.93.in-addr.arpa.  IN  PTR  example.com.
```

**Pour IPv6 :**
```
Adresse IPv6 : 2001:db8::1

Ã‰tapes :
1. DÃ©velopper complÃ¨tement : 2001:0db8:0000:0000:0000:0000:0000:0001
2. Inverser caractÃ¨re par caractÃ¨re (nibble)
3. Ajouter .ip6.arpa

RÃ©sultat :
1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa.
```

### Exemples

```dns
; PTR IPv4
34.216.184.93.in-addr.arpa.  86400  IN  PTR  example.com.
50.216.184.93.in-addr.arpa.  86400  IN  PTR  mail.example.com.
60.216.184.93.in-addr.arpa.  86400  IN  PTR  ftp.example.com.

; PTR IPv6
1.0.0.0...0.0.2.ip6.arpa.    86400  IN  PTR  example.com.
```

### Cas d'usage

**1. Serveurs de messagerie**
```
VÃ©rification anti-spam :

Serveur reÃ§oit email de 93.184.216.50
1. RÃ©solution PTR : 50.216.184.93.in-addr.arpa
   â†’ RÃ©ponse : mail.example.com

2. VÃ©rification forward (A) : mail.example.com
   â†’ RÃ©ponse : 93.184.216.50

3. VÃ©rification : Les deux correspondent ? âœ“
   â†’ Email probablement lÃ©gitime
```

Beaucoup de serveurs de messagerie **rejettent** les emails dont l'IP source n'a pas de PTR ou dont le PTR ne correspond pas.

**2. Logs et diagnostics**
```
Logs avec PTR :
2024-12-06 10:30:15 mail.example.com [93.184.216.50] connected

Logs sans PTR :
2024-12-06 10:30:15 [93.184.216.50] connected

Plus lisible avec PTR !
```

**3. SÃ©curitÃ© et traÃ§abilitÃ©**
```bash
# Identifier la source d'une connexion
$ dig -x 8.8.8.8

dns.google.   â† Plus informatif que juste l'IP
```

### Gestion des PTR

**Important :** Les enregistrements PTR sont gÃ©rÃ©s par le **propriÃ©taire du bloc IP**, gÃ©nÃ©ralement votre fournisseur d'hÃ©bergement ou FAI, **pas par vous** directement.

```
Vous possÃ©dez : example.com (domaine)
â”œâ”€ Vous gÃ©rez : A, AAAA, MX, TXT, etc.

Votre hÃ©bergeur possÃ¨de : 93.184.216.0/24 (bloc IP)
â”œâ”€ HÃ©bergeur gÃ¨re : PTR pour ces IPs
â””â”€ Vous devez demander la configuration du PTR
```

### Configuration typique chez un hÃ©bergeur

```
Interface hÃ©bergeur :
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
IP : 93.184.216.50
PTR : [mail.example.com] [Mettre Ã  jour]
```

### RequÃªte et rÃ©ponse

```bash
# RÃ©solution inverse avec dig
$ dig -x 93.184.216.34

; <<>> DiG 9.18.24 <<>> -x 93.184.216.34
;; QUESTION SECTION:
;34.216.184.93.in-addr.arpa.    IN      PTR

;; ANSWER SECTION:
34.216.184.93.in-addr.arpa. 86400 IN   PTR     example.com.

;; Query time: 45 msec
```

## SOA - Start of Authority

### Description

L'enregistrement **SOA** (Start of Authority) contient les **mÃ©tadonnÃ©es administratives** d'une zone DNS. C'est le premier enregistrement de toute zone DNS.

### Format

```
zone  TTL  IN  SOA  serveur_primaire  contact_email  (
                    serial        ; NumÃ©ro de sÃ©rie
                    refresh       ; Intervalle de rafraÃ®chissement
                    retry         ; Intervalle de rÃ©essai
                    expire        ; DÃ©lai d'expiration
                    minimum       ; TTL minimum/nÃ©gatif
                    )
```

### Exemple complet

```dns
example.com.  86400  IN  SOA  ns1.example.com. admin.example.com. (
                             2024120601  ; Serial (YYYYMMDDnn)
                             3600        ; Refresh (1 heure)
                             1800        ; Retry (30 minutes)
                             604800      ; Expire (1 semaine)
                             86400       ; Minimum TTL (24 heures)
                             )
```

### Champs dÃ©taillÃ©s

**1. Serveur primaire (MNAME)**
```
ns1.example.com.
â””â”€ Serveur DNS master autoritaire pour cette zone
```

**2. Contact email (RNAME)**
```
admin.example.com.
â””â”€ Email de l'administrateur : admin@example.com
   (@ remplacÃ© par . dans le DNS)

Si l'email contient un point :
john.doe@example.com â†’ john\.doe.example.com.
                       â””â”€ Point Ã©chappÃ© avec backslash
```

**3. Serial (numÃ©ro de sÃ©rie)**
```
Format recommandÃ© : YYYYMMDDnn
2024120601
â””â”€ 2024-12-06, version 01

Importance :
â€¢ Les serveurs secondaires vÃ©rifient ce numÃ©ro
â€¢ Si serial > leur version â†’ Ils se mettent Ã  jour
â€¢ TOUJOURS incrÃ©menter aprÃ¨s modification !
```

**4. Refresh (rafraÃ®chissement)**
```
3600 (1 heure)
â””â”€ Intervalle auquel les secondaires vÃ©rifient les mises Ã  jour

Valeurs typiques :
â€¢ Zones stables : 86400 (24h)
â€¢ Zones actives : 3600 (1h)
â€¢ Zones trÃ¨s actives : 900 (15min)
```

**5. Retry (rÃ©essai)**
```
1800 (30 minutes)
â””â”€ Si Ã©chec du refresh, rÃ©essayer aprÃ¨s ce dÃ©lai

GÃ©nÃ©ralement : Retry = Refresh / 2
```

**6. Expire (expiration)**
```
604800 (1 semaine)
â””â”€ Si impossible de contacter le primaire pendant ce dÃ©lai,
   les secondaires arrÃªtent de rÃ©pondre pour cette zone

Valeurs typiques : 1-4 semaines
```

**7. Minimum TTL**
```
86400 (24 heures)
â””â”€ TTL pour les rÃ©ponses nÃ©gatives (NXDOMAIN)
   "Ce domaine n'existe pas" sera cachÃ© 24h

Valeurs typiques : 1-24 heures
```

### ScÃ©nario de synchronisation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Serveur primaire modifiÃ©                                 â”‚
â”‚ Serial : 2024120601 â†’ 2024120602                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ AprÃ¨s 'refresh' secondes (3600 = 1h)
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Serveur secondaire vÃ©rifie le serial                     â”‚
â”‚ Mon serial : 2024120601                                  â”‚
â”‚ Serial primaire : 2024120602                             â”‚
â”‚ â†’ 2024120602 > 2024120601 â†’ Mise Ã  jour nÃ©cessaire !     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Transfert de zone (AXFR ou IXFR)                         â”‚
â”‚ Secondaire synchronisÃ© avec serial 2024120602            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### RequÃªte et rÃ©ponse

```bash
$ dig example.com SOA

; <<>> DiG 9.18.24 <<>> example.com SOA
;; QUESTION SECTION:
;example.com.                   IN      SOA

;; ANSWER SECTION:
example.com.    86400   IN      SOA     ns.icann.org. noc.dns.icann.org. (
                                        2024092366  ; serial
                                        7200        ; refresh (2 hours)
                                        3600        ; retry (1 hour)
                                        1209600     ; expire (2 weeks)
                                        3600        ; minimum (1 hour)
                                        )

;; Query time: 32 msec
```

## SRV - Service Record

### Description

L'enregistrement **SRV** (Service) permet de dÃ©finir la **localisation de services spÃ©cifiques** (hÃ´te et port).

### Format

```
_service._protocole.domaine  TTL  IN  SRV  prioritÃ©  poids  port  cible

Exemple :
_sip._tcp.example.com.  3600  IN  SRV  10  60  5060  sipserver.example.com.
â”‚    â”‚                             â”‚   â”‚   â”‚    â”‚
â”‚    â”‚                             â”‚   â”‚   â”‚    â””â”€ Nom d'hÃ´te
â”‚    â”‚                             â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€ Port du service
â”‚    â”‚                             â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Poids (load balancing)
â”‚    â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PrioritÃ©
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Protocole (tcp/udp)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Service
```

### Exemples de services

```dns
; SIP (VoIP)
_sip._tcp.example.com.     IN  SRV  10  60  5060  sipserver1.example.com.
_sip._tcp.example.com.     IN  SRV  10  40  5060  sipserver2.example.com.
_sip._udp.example.com.     IN  SRV  10  50  5060  sipserver1.example.com.

; XMPP (Jabber)
_xmpp-client._tcp.example.com.  IN  SRV  5  0  5222  xmpp.example.com.
_xmpp-server._tcp.example.com.  IN  SRV  5  0  5269  xmpp.example.com.

; LDAP
_ldap._tcp.example.com.    IN  SRV  0  0  389  ldap.example.com.
_ldaps._tcp.example.com.   IN  SRV  0  0  636  ldap.example.com.

; Minecraft
_minecraft._tcp.example.com.  IN  SRV  0  5  25565  mc.example.com.

; CalDAV/CardDAV
_caldavs._tcp.example.com.  IN  SRV  0  1  443  calendar.example.com.
_carddavs._tcp.example.com. IN  SRV  0  1  443  contacts.example.com.
```

### PrioritÃ© et poids

**PrioritÃ© :** Comme pour MX, **plus bas = plus prioritaire**

**Poids :** Pour les services de mÃªme prioritÃ©, rÃ©partition de la charge

```
_sip._tcp.example.com.  IN  SRV  10  60  5060  server1.example.com.
_sip._tcp.example.com.  IN  SRV  10  40  5060  server2.example.com.
                             â†‘   â†‘
                             â”‚   â””â”€ Poids
                             â””â”€â”€â”€â”€â”€ PrioritÃ©

Calcul de la rÃ©partition :
server1 : 60 / (60+40) = 60%
server2 : 40 / (60+40) = 40%
```

### Cas d'usage

**DÃ©couverte automatique de services :**
```
Client VoIP veut se connecter Ã  example.com :

1. RequÃªte DNS : _sip._tcp.example.com SRV
2. RÃ©ponse : sipserver.example.com:5060
3. Connexion directe au bon serveur et port

Pas besoin de configuration manuelle !
```

### RequÃªte et rÃ©ponse

```bash
$ dig _sip._tcp.example.com SRV

; <<>> DiG 9.18.24 <<>> _sip._tcp.example.com SRV
;; QUESTION SECTION:
;_sip._tcp.example.com.         IN      SRV

;; ANSWER SECTION:
_sip._tcp.example.com.  3600    IN      SRV     10 60 5060 sipserver1.example.com.
_sip._tcp.example.com.  3600    IN      SRV     10 40 5060 sipserver2.example.com.

;; ADDITIONAL SECTION:
sipserver1.example.com. 3600    IN      A       93.184.216.70
sipserver2.example.com. 3600    IN      A       93.184.216.71

;; Query time: 28 msec
```

## CAA - Certification Authority Authorization

### Description

L'enregistrement **CAA** (Certification Authority Authorization) spÃ©cifie quelles **autoritÃ©s de certification** sont autorisÃ©es Ã  Ã©mettre des certificats SSL/TLS pour le domaine.

### Format

```
domaine  TTL  IN  CAA  flags  tag  "valeur"
```

### Exemples

```dns
; Autoriser Let's Encrypt uniquement
example.com.  IN  CAA  0  issue "letsencrypt.org"

; Autoriser plusieurs CA
example.com.  IN  CAA  0  issue "letsencrypt.org"
example.com.  IN  CAA  0  issue "digicert.com"
example.com.  IN  CAA  0  issue "sectigo.com"

; Interdire toute Ã©mission de certificat
example.com.  IN  CAA  0  issue ";"

; Autoriser pour sous-domaines (wildcard)
example.com.  IN  CAA  0  issuewild "letsencrypt.org"

; Email de notification en cas de problÃ¨me
example.com.  IN  CAA  0  iodef "mailto:security@example.com"

; Combinaison complÃ¨te
example.com.  IN  CAA  0  issue "letsencrypt.org"
example.com.  IN  CAA  0  issuewild "letsencrypt.org"
example.com.  IN  CAA  0  iodef "mailto:security@example.com"
```

### Tags principaux

| Tag | Description | Exemple |
|-----|-------------|---------|
| **issue** | CA autorisÃ©e pour certificats standard | `issue "letsencrypt.org"` |
| **issuewild** | CA autorisÃ©e pour certificats wildcard | `issuewild "letsencrypt.org"` |
| **iodef** | Contact pour notifications | `iodef "mailto:admin@example.com"` |

### SÃ©curitÃ© apportÃ©e

```
Sans CAA :
N'importe quelle CA peut Ã©mettre un certificat pour example.com
â””â”€ Risque : Certificat frauduleux

Avec CAA :
example.com.  IN  CAA  0  issue "letsencrypt.org"
â””â”€ Seul Let's Encrypt peut Ã©mettre un certificat
â””â”€ Autres CA vÃ©rifient CAA et refusent
```

### VÃ©rification par les CA

Avant d'Ã©mettre un certificat, les CA **doivent** vÃ©rifier :
1. Y a-t-il un enregistrement CAA ?
2. Suis-je autorisÃ© dans cet enregistrement ?
3. Si non â†’ Refuser la demande

### RequÃªte et rÃ©ponse

```bash
$ dig example.com CAA

; <<>> DiG 9.18.24 <<>> example.com CAA
;; QUESTION SECTION:
;example.com.                   IN      CAA

;; ANSWER SECTION:
example.com.            3600    IN      CAA     0 issue "letsencrypt.org"
example.com.            3600    IN      CAA     0 issuewild "letsencrypt.org"

;; Query time: 21 msec
```

## Autres types d'enregistrements

### AAAA vs A6 (obsolÃ¨te)

A6 Ã©tait une alternative Ã  AAAA pour IPv6, mais a Ã©tÃ© **abandonnÃ©**. Utilisez toujours **AAAA** pour IPv6.

### ALIAS et ANAME (non standards)

Certains fournisseurs DNS (Cloudflare, DNSimple, AWS Route 53) offrent des enregistrements **ALIAS** ou **ANAME** qui fonctionnent comme CNAME mais **autorisÃ©s Ã  la racine** :

```dns
; Standard : INTERDIT
example.com.  IN  CNAME  other.com.

; ALIAS : AutorisÃ© (mais non standard RFC)
example.com.  IN  ALIAS  other.com.
```

**Fonctionnement :** Le serveur DNS rÃ©sout automatiquement le CNAME et retourne directement les A/AAAA.

### DNAME - Delegation Name

Similaire Ã  CNAME mais pour **toute une sous-arborescence** :

```dns
; Rediriger tous les sous-domaines de old.example.com vers new.example.com
old.example.com.  IN  DNAME  new.example.com.

RÃ©sultat :
www.old.example.com â†’ www.new.example.com
mail.old.example.com â†’ mail.new.example.com
blog.old.example.com â†’ blog.new.example.com
```

### NAPTR - Naming Authority Pointer

UtilisÃ© pour des transformations complexes, notamment en tÃ©lÃ©phonie (ENUM) :

```dns
; Convertir numÃ©ro de tÃ©lÃ©phone en URI SIP
4.3.2.1.5.5.5.1.2.1.e164.arpa.  IN  NAPTR  10  100  "u"  "E2U+sip"  "!^.*$!sip:info@example.com!"  .
```

TrÃ¨s spÃ©cialisÃ©, rarement utilisÃ© en dehors de la tÃ©lÃ©phonie.

## Tableau rÃ©capitulatif

| Type | Usage principal | DonnÃ©es | Peut avoir multiples | Ã€ la racine |
|------|----------------|---------|---------------------|-------------|
| **A** | IPv4 | Adresse IPv4 | âœ… | âœ… |
| **AAAA** | IPv6 | Adresse IPv6 | âœ… | âœ… |
| **CNAME** | Alias | Nom de domaine | âŒ | âŒ |
| **MX** | Email | PrioritÃ© + nom serveur | âœ… | âœ… |
| **NS** | Serveurs DNS | Nom serveur DNS | âœ… | âœ… (obligatoire) |
| **TXT** | Texte/validation | ChaÃ®ne texte | âœ… | âœ… |
| **PTR** | RÃ©solution inverse | Nom de domaine | âŒ | âœ… |
| **SOA** | MÃ©tadonnÃ©es zone | ParamÃ¨tres zone | âŒ | âœ… (obligatoire) |
| **SRV** | Services | Prio+poids+port+hÃ´te | âœ… | âš ï¸ |
| **CAA** | AutoritÃ© certif. | CA autorisÃ©e | âœ… | âœ… |

## Bonnes pratiques

### Configuration minimale d'un domaine

```dns
; SOA (obligatoire)
example.com.  86400  IN  SOA  ns1.example.com. admin.example.com. (
                            2024120601 3600 1800 604800 86400 )

; NS (obligatoire, minimum 2)
example.com.  86400  IN  NS   ns1.example.com.
example.com.  86400  IN  NS   ns2.example.com.

; A pour la racine et www
example.com.      3600  IN  A    93.184.216.34
www.example.com.  3600  IN  A    93.184.216.34

; AAAA pour IPv6
example.com.      3600  IN  AAAA 2606:2800:220::1
www.example.com.  3600  IN  AAAA 2606:2800:220::1

; MX pour les emails
example.com.  3600  IN  MX  10  mail.example.com.

; Serveur de mail
mail.example.com.  3600  IN  A  93.184.216.50

; TXT pour SPF
example.com.  3600  IN  TXT  "v=spf1 mx ~all"

; Serveurs DNS avec leurs IPs (glue records)
ns1.example.com.  86400  IN  A  203.0.113.10
ns2.example.com.  86400  IN  A  203.0.113.11
```

### TTL recommandÃ©s

```
Type d'enregistrement        TTL recommandÃ©    Raison
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SOA, NS                      86400 (24h)       Rarement modifiÃ©
A, AAAA (stable)             3600 (1h)         Bon compromis
A, AAAA (load balancing)     300 (5min)        Changements frÃ©quents
MX                           3600 (1h)         Rarement modifiÃ©
TXT (SPF, DKIM)              3600 (1h)         Rarement modifiÃ©
CNAME                        3600 (1h)         Suit la cible
PTR                          86400 (24h)       TrÃ¨s rarement modifiÃ©

Pendant une migration :      60-300 (1-5min)   Changement rapide
```

### Ordre de prioritÃ© pour rÃ©solution

Quand un client demande un domaine, voici comment le rÃ©solveur procÃ¨de :

```
1. VÃ©rifie le cache local
2. Si absent, requÃªte DNS :
   a) PrÃ©fÃ¨re AAAA (IPv6) si disponible
   b) Utilise A (IPv4) en fallback
   c) Suit les CNAME si prÃ©sents
3. Met en cache selon TTL
```

## Points clÃ©s Ã  retenir

ğŸ”‘ **A et AAAA** : Mapping nom â†’ IP (IPv4 et IPv6)

ğŸ”‘ **CNAME** : Alias, mais interdit Ã  la racine et avec autres enregistrements

ğŸ”‘ **MX** : Serveurs de messagerie avec prioritÃ©

ğŸ”‘ **NS** : Serveurs DNS autoritaires (dÃ©lÃ©gation)

ğŸ”‘ **TXT** : Validation, SPF, DKIM, DMARC, vÃ©rifications

ğŸ”‘ **PTR** : RÃ©solution inverse (IP â†’ nom), gÃ©rÃ© par le propriÃ©taire IP

ğŸ”‘ **SOA** : MÃ©tadonnÃ©es de zone (serial crucial pour synchronisation)

ğŸ”‘ **SRV** : DÃ©couverte automatique de services (port+hÃ´te)

ğŸ”‘ **CAA** : SÃ©curitÃ© SSL/TLS (autoritÃ©s de certification autorisÃ©es)

---

## Ce que nous avons appris

Dans cette section, nous avons explorÃ© en dÃ©tail :

- âœ… Les 9 types d'enregistrements DNS les plus importants
- âœ… Le format et la structure de chaque type
- âœ… Des exemples concrets d'utilisation
- âœ… Les cas d'usage pratiques et les bonnes pratiques
- âœ… Les restrictions et limitations de chaque type
- âœ… Comment interroger ces enregistrements avec dig
- âœ… Les configurations typiques pour diffÃ©rents scÃ©narios
- âœ… Les aspects de sÃ©curitÃ© (SPF, DKIM, DMARC, CAA)

## Pour aller plus loin

Maintenant que vous maÃ®trisez les types d'enregistrements DNS, nous allons explorer les **mÃ©canismes de rÃ©solution** : rÃ©solution rÃ©cursive vs itÃ©rative, et comment les rÃ©solveurs parcourent la hiÃ©rarchie DNS pour obtenir une rÃ©ponse.

---

**Prochaine section : RÃ©solution rÃ©cursive vs itÃ©rative** ğŸ‘‰

â­ï¸ [RÃ©solution rÃ©cursive vs itÃ©rative](/05-couche-application/02.3-dns-resolution.md)
