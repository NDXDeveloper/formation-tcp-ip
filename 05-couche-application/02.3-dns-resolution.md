ğŸ” Retour au [Sommaire](/SOMMAIRE.md)

# 5.2.3 RÃ©solution rÃ©cursive vs itÃ©rative

## Introduction

La rÃ©solution DNS repose sur deux mÃ©canismes fondamentaux qui travaillent ensemble : la **rÃ©solution rÃ©cursive** et la **rÃ©solution itÃ©rative**. Comprendre la diffÃ©rence entre ces deux modes est essentiel pour :
- Diagnostiquer les problÃ¨mes DNS
- Optimiser les performances
- Comprendre le rÃ´le de chaque acteur (client, rÃ©solveur, serveurs autoritaires)
- SÃ©curiser correctement son infrastructure DNS

Dans cette section, nous allons explorer en dÃ©tail ces deux modes de rÃ©solution, comment ils interagissent, et quand chacun est utilisÃ©.

## Vue d'ensemble : Les acteurs du DNS

Avant de plonger dans les mÃ©canismes, identifions les trois acteurs principaux :

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ACTEURS DU DNS                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. CLIENT (Stub Resolver)                                  â”‚
â”‚     â€¢ Votre ordinateur, smartphone, serveur                 â”‚
â”‚     â€¢ Envoie des requÃªtes rÃ©cursives                        â”‚
â”‚     â€¢ Cache local limitÃ©                                    â”‚
â”‚                                                             â”‚
â”‚  2. RÃ‰SOLVEUR RÃ‰CURSIF (Recursive Resolver)                 â”‚
â”‚     â€¢ Serveur DNS intermÃ©diaire                             â”‚
â”‚     â€¢ Fait tout le travail pour le client                   â”‚
â”‚     â€¢ Cache important                                       â”‚
â”‚     â€¢ Exemples : 8.8.8.8, 1.1.1.1, DNS du FAI               â”‚
â”‚                                                             â”‚
â”‚  3. SERVEURS AUTORITAIRES (Authoritative Servers)           â”‚
â”‚     â€¢ Serveurs racine, TLD, et domaines                     â”‚
â”‚     â€¢ RÃ©pondent de maniÃ¨re itÃ©rative                        â”‚
â”‚     â€¢ Source de vÃ©ritÃ© pour leurs zones                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## RÃ©solution rÃ©cursive

### DÃ©finition

Une **requÃªte rÃ©cursive** signifie : *"Donne-moi la rÃ©ponse finale, fais tout le travail nÃ©cessaire pour moi"*.

Le client dÃ©lÃ¨gue **entiÃ¨rement** la rÃ©solution au serveur DNS :
- Le serveur **doit** retourner une rÃ©ponse complÃ¨te
- Le serveur fait toutes les requÃªtes intermÃ©diaires nÃ©cessaires
- Le client attend simplement la rÃ©ponse finale

### SchÃ©ma de base

```
Client (Stub Resolver)           RÃ©solveur rÃ©cursif
       â”‚                                â”‚
       â”‚  "Quelle est l'IP de           â”‚
       â”‚   www.example.com ?"           â”‚
       â”‚  (requÃªte rÃ©cursive)           â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                                â”‚
       â”‚         (le rÃ©solveur          â”‚
       â”‚          fait tout             â”‚
       â”‚          le travail)           â”‚
       â”‚                                â”‚
       â”‚  "C'est 93.184.216.34"         â”‚
       â”‚  (rÃ©ponse complÃ¨te)            â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                                â”‚
```

### CaractÃ©ristiques d'une requÃªte rÃ©cursive

**En-tÃªte DNS d'une requÃªte rÃ©cursive :**
```
Flags :
â”œâ”€ RD (Recursion Desired) : 1  â† "Je veux la rÃ©cursion"
â”œâ”€ QR (Query/Response)    : 0  â† C'est une question
â””â”€ ...

Le bit RD=1 indique : "Fais tout le travail pour moi"
```

**RÃ©ponse Ã  une requÃªte rÃ©cursive :**
```
Flags :
â”œâ”€ QR (Query/Response)     : 1  â† C'est une rÃ©ponse
â”œâ”€ RD (Recursion Desired)  : 1  â† Le client l'avait demandÃ©
â”œâ”€ RA (Recursion Available): 1  â† Le serveur l'a fait
â””â”€ ...
```

### Exemple concret avec dig

**RequÃªte rÃ©cursive normale :**
```bash
$ dig www.google.com @8.8.8.8

; <<>> DiG 9.18.24 <<>> www.google.com @8.8.8.8
;; flags: qr rd ra; QUERY: 1, ANSWER: 1
           â”‚  â”‚  â”‚
           â”‚  â”‚  â””â”€ RA=1 : Recursion Available (rÃ©cursion effectuÃ©e)
           â”‚  â””â”€â”€â”€â”€ RD=1 : Recursion Desired (rÃ©cursion demandÃ©e)
           â””â”€â”€â”€â”€â”€â”€â”€ QR=1 : Query Response (c'est une rÃ©ponse)

;; QUESTION SECTION:
;www.google.com.                IN      A

;; ANSWER SECTION:
www.google.com.         161     IN      A       142.250.185.196

;; Query time: 15 msec
;; SERVER: 8.8.8.8#53(8.8.8.8)
```

**Le client ne voit que :**
- Question : www.google.com ?
- RÃ©ponse : 142.250.185.196
- Temps : 15ms

**Il ne sait pas que le rÃ©solveur a :**
- InterrogÃ© les serveurs racine
- InterrogÃ© les serveurs .com
- InterrogÃ© les serveurs google.com
- Mis en cache le rÃ©sultat

### Avantages de la rÃ©solution rÃ©cursive

```
Pour le CLIENT :
âœ… SimplicitÃ© extrÃªme
âœ… Une seule requÃªte Ã  faire
âœ… Pas de logique complexe Ã  implÃ©menter
âœ… Rapide grÃ¢ce au cache du rÃ©solveur

Pour le RÃ‰SOLVEUR :
âœ… ContrÃ´le total du processus
âœ… Peut optimiser (cache, parallÃ©lisation)
âœ… Peut implÃ©menter des politiques (filtrage, logging)
```

### InconvÃ©nients de la rÃ©solution rÃ©cursive

```
Pour le RÃ‰SOLVEUR :
âŒ Charge importante (fait tout le travail)
âŒ Consommation mÃ©moire (cache)
âŒ Cible potentielle pour attaques (amplification)
âŒ ResponsabilitÃ© de la performance

Pour le CLIENT :
âŒ DÃ©pendance totale au rÃ©solveur
âŒ Pas de contrÃ´le du processus
âŒ Le rÃ©solveur voit toutes les requÃªtes
```

## RÃ©solution itÃ©rative

### DÃ©finition

Une **requÃªte itÃ©rative** signifie : *"Donne-moi la meilleure rÃ©ponse que tu as, mais ne fais pas de requÃªtes supplÃ©mentaires pour moi"*.

Le serveur interrogÃ© :
- Retourne la rÃ©ponse s'il la connaÃ®t
- **OU** indique oÃ¹ chercher ensuite (rÃ©fÃ©rence)
- Ne fait **pas** de requÃªtes supplÃ©mentaires

### SchÃ©ma de base

```
RÃ©solveur                     Serveur autoritaire
    â”‚                                â”‚
    â”‚  "OÃ¹ est www.example.com ?"    â”‚
    â”‚  (requÃªte itÃ©rative)           â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                                â”‚
    â”‚  "Je ne sais pas exactement,   â”‚
    â”‚   mais demande Ã  ces serveurs: â”‚
    â”‚   ns1.example.com"             â”‚
    â”‚  (rÃ©fÃ©rence)                   â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                â”‚
```

Le demandeur doit ensuite **lui-mÃªme** interroger le serveur rÃ©fÃ©rencÃ©.

### CaractÃ©ristiques d'une requÃªte itÃ©rative

**En-tÃªte DNS d'une requÃªte itÃ©rative :**
```
Flags :
â”œâ”€ RD (Recursion Desired) : 0  â† "Ne fais pas de rÃ©cursion"
â”œâ”€ QR (Query/Response)    : 0  â† C'est une question
â””â”€ ...

Le bit RD=0 indique : "Donne-moi juste ce que tu sais"
```

**RÃ©ponse Ã  une requÃªte itÃ©rative :**
```
RÃ©ponse avec rÃ©fÃ©rence (pas de rÃ©ponse finale) :
Flags : qr (pas de ra car pas de rÃ©cursion)

ANSWER SECTION : (vide ou pas de rÃ©ponse finale)
AUTHORITY SECTION : (serveurs NS vers qui se tourner)
ADDITIONAL SECTION : (IPs des serveurs NS - glue records)
```

### Exemple concret avec dig

**RequÃªte itÃ©rative (sans rÃ©cursion) :**
```bash
$ dig www.google.com @a.root-servers.net +norecurse

; <<>> DiG 9.18.24 <<>> www.google.com @a.root-servers.net +norecurse
;; flags: qr; QUERY: 1, ANSWER: 0
           â”‚
           â””â”€ QR=1 mais pas de RD ni RA (pas de rÃ©cursion)

;; QUESTION SECTION:
;www.google.com.                IN      A

;; ANSWER SECTION:
(vide - le serveur racine ne connaÃ®t pas www.google.com)

;; AUTHORITY SECTION: (rÃ©fÃ©rence vers .com)
com.                    172800  IN      NS      a.gtld-servers.net.
com.                    172800  IN      NS      b.gtld-servers.net.
com.                    172800  IN      NS      c.gtld-servers.net.
; ... (13 serveurs .com)

;; ADDITIONAL SECTION: (glue records)
a.gtld-servers.net.     172800  IN      A       192.5.6.30
a.gtld-servers.net.     172800  IN      AAAA    2001:503:a83e::2:30
b.gtld-servers.net.     172800  IN      A       192.33.14.30
; ...

;; Query time: 45 msec
;; SERVER: 198.41.0.4#53(a.root-servers.net)
```

**InterprÃ©tation :**
- Le serveur racine ne donne **pas** l'IP de www.google.com
- Il indique : "Pour .com, demandez Ã  a.gtld-servers.net (192.5.6.30)"
- C'est au demandeur de faire la requÃªte suivante

### Avantages de la rÃ©solution itÃ©rative

```
Pour le SERVEUR AUTORITAIRE :
âœ… Charge minimale (une seule rÃ©ponse)
âœ… Pas de rÃ©cursion Ã  gÃ©rer
âœ… ScalabilitÃ© excellente
âœ… RÃ´le simple et bien dÃ©fini

Pour le SYSTÃˆME DNS :
âœ… Distribution de la charge
âœ… Pas de point unique de surcharge
âœ… Chaque serveur fait son travail spÃ©cifique
```

### InconvÃ©nients de la rÃ©solution itÃ©rative

```
Pour le DEMANDEUR :
âŒ Doit gÃ©rer la logique complexe
âŒ Plusieurs requÃªtes Ã  faire
âŒ Plus de temps rÃ©seau
âŒ Plus de code Ã  Ã©crire/maintenir
```

## Le processus complet : RÃ©cursif + ItÃ©ratif

Dans la pratique, DNS combine les deux modes :
1. Le **client** fait une requÃªte **rÃ©cursive** au rÃ©solveur
2. Le **rÃ©solveur** fait des requÃªtes **itÃ©ratives** aux serveurs autoritaires

### ScÃ©nario complet dÃ©taillÃ©

RÃ©solvons `www.example.com` depuis zÃ©ro (sans cache) :

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1 : CLIENT â†’ RÃ‰SOLVEUR (RÃ‰CURSIF)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Client (192.168.1.100)
    â”‚
    â”‚ RequÃªte DNS (UDP, port 53)
    â”‚ Question : www.example.com A ?
    â”‚ Flags : qr=0, rd=1 (rÃ©cursion dÃ©sirÃ©e)
    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
                                                    RÃ©solveur rÃ©cursif (8.8.8.8)
                                                         â”‚
                                                         â”‚ (vÃ©rifie cache : absent)
                                                         â”‚
                                                         â”‚ Lance rÃ©solution itÃ©rative...

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2 : RÃ‰SOLVEUR â†’ SERVEURS (ITÃ‰RATIF)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 1 : Interrogation serveur RACINE                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur (8.8.8.8)
    â”‚
    â”‚ RequÃªte DNS
    â”‚ Question : www.example.com A ?
    â”‚ Flags : qr=0, rd=0 (pas de rÃ©cursion)
    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
                                            Serveur racine (198.41.0.4)
                                                         â”‚
                                                         â”‚ "Je ne connais pas
                                                         â”‚  www.example.com,
                                                         â”‚  mais voici les
                                                         â”‚  serveurs pour .com"
                                                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚
    â”‚ RÃ©ponse DNS
    â”‚ AUTHORITY: com. NS a.gtld-servers.net
    â”‚ ADDITIONAL: a.gtld-servers.net A 192.5.6.30
    â”‚

RÃ©solveur reÃ§oit :
â€¢ Pas de rÃ©ponse finale
â€¢ RÃ©fÃ©rence : Demander aux serveurs .com
â€¢ IP du serveur .com : 192.5.6.30

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 2 : Interrogation serveur TLD (.com)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur (8.8.8.8)
    â”‚
    â”‚ RequÃªte DNS
    â”‚ Question : www.example.com A ?
    â”‚ Flags : qr=0, rd=0 (pas de rÃ©cursion)
    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
                                        Serveur .com (192.5.6.30)
                                                         â”‚
                                                         â”‚ "Je ne connais pas
                                                         â”‚  www.example.com,
                                                         â”‚  mais voici les
                                                         â”‚  serveurs pour
                                                         â”‚  example.com"
                                                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚
    â”‚ RÃ©ponse DNS
    â”‚ AUTHORITY: example.com NS ns1.example.com
    â”‚ ADDITIONAL: ns1.example.com A 203.0.113.10
    â”‚

RÃ©solveur reÃ§oit :
â€¢ Pas de rÃ©ponse finale
â€¢ RÃ©fÃ©rence : Demander Ã  ns1.example.com
â€¢ IP : 203.0.113.10

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 3 : Interrogation serveur AUTORITAIRE                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur (8.8.8.8)
    â”‚
    â”‚ RequÃªte DNS
    â”‚ Question : www.example.com A ?
    â”‚ Flags : qr=0, rd=0 (pas de rÃ©cursion)
    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
                                Serveur autoritaire (203.0.113.10)
                                                         â”‚
                                                         â”‚ "Je suis autoritaire
                                                         â”‚  pour example.com,
                                                         â”‚  voici la rÃ©ponse !"
                                                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚
    â”‚ RÃ©ponse DNS
    â”‚ Flags : qr=1, aa=1 (authoritative answer)
    â”‚ ANSWER: www.example.com A 93.184.216.34
    â”‚ TTL: 3600
    â”‚

RÃ©solveur reÃ§oit :
â€¢ RÃ©ponse finale ! âœ“
â€¢ IP : 93.184.216.34
â€¢ TTL : 3600 secondes (met en cache)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3 : RÃ‰SOLVEUR â†’ CLIENT (RÃ‰PONSE RÃ‰CURSIVE)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur rÃ©cursif (8.8.8.8)
    â”‚
    â”‚ RÃ©ponse DNS
    â”‚ Question : www.example.com A ?
    â”‚ Flags : qr=1, rd=1, ra=1 (rÃ©cursion effectuÃ©e)
    â”‚ ANSWER: www.example.com A 93.184.216.34
    â”‚ TTL: 3600
    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
                                                    Client (192.168.1.100)

Client reÃ§oit :
â€¢ RÃ©ponse complÃ¨te
â€¢ IP : 93.184.216.34
â€¢ Temps total : ~100-150ms
```

### Comptage des requÃªtes

```
RequÃªtes DNS totales pour une rÃ©solution complÃ¨te (sans cache) :

1 requÃªte du client au rÃ©solveur (rÃ©cursive)
+
3 requÃªtes du rÃ©solveur aux serveurs (itÃ©ratives) :
  â””â”€ 1Ã— vers serveur racine
  â””â”€ 1Ã— vers serveur TLD
  â””â”€ 1Ã— vers serveur autoritaire
+
1 rÃ©ponse finale au client
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
= 5 messages DNS au total

Sur le rÃ©seau :
â€¢ Client voit : 2 paquets (1 question, 1 rÃ©ponse)
â€¢ RÃ©solveur gÃ©nÃ¨re : 6 paquets supplÃ©mentaires
â€¢ Total : 8 paquets UDP sur le rÃ©seau
```

## Visualisation avec dig +trace

La commande `dig +trace` simule la rÃ©solution itÃ©rative :

```bash
$ dig +trace www.example.com

; <<>> DiG 9.18.24 <<>> +trace www.example.com

# Ã‰tape 1 : Serveurs racine
.                       515579  IN      NS      a.root-servers.net.
.                       515579  IN      NS      b.root-servers.net.
; ... (13 serveurs racine)

# Ã‰tape 2 : Interrogation .com
com.                    172800  IN      NS      a.gtld-servers.net.
com.                    172800  IN      NS      b.gtld-servers.net.
; ... (serveurs .com)

# Ã‰tape 3 : Interrogation example.com
example.com.            172800  IN      NS      a.iana-servers.net.
example.com.            172800  IN      NS      b.iana-servers.net.

# Ã‰tape 4 : RÃ©ponse finale
www.example.com.        86400   IN      A       93.184.216.34

;; Query time: 145 msec
```

**InterprÃ©tation :**
- `dig +trace` fait **lui-mÃªme** les requÃªtes itÃ©ratives
- Il montre chaque Ã©tape de la rÃ©solution
- Chaque bloc reprÃ©sente une rÃ©ponse d'un niveau diffÃ©rent

## Impact du cache DNS

Le cache change radicalement le nombre de requÃªtes nÃ©cessaires.

### ScÃ©nario 1 : Pas de cache (cold start)

```
RÃ©solution de www.example.com :

Client â†’ RÃ©solveur : www.example.com ?
RÃ©solveur â†’ Racine : www.example.com ? â†’ "Demande .com"
RÃ©solveur â†’ .com : www.example.com ? â†’ "Demande ns1.example.com"
RÃ©solveur â†’ ns1.example.com : www.example.com ? â†’ "93.184.216.34"
RÃ©solveur â†’ Client : 93.184.216.34

RequÃªtes itÃ©ratives : 3
Temps total : ~150ms
```

### ScÃ©nario 2 : Cache partiel (serveurs TLD en cache)

```
RÃ©solution de www.another-example.com :
(les serveurs .com sont dÃ©jÃ  en cache)

Client â†’ RÃ©solveur : www.another-example.com ?
RÃ©solveur (cache) : "Je connais les serveurs .com"
RÃ©solveur â†’ .com : www.another-example.com ? â†’ "Demande ns1.another-example.com"
RÃ©solveur â†’ ns1.another-example.com : www.another-example.com ? â†’ "IP"
RÃ©solveur â†’ Client : RÃ©ponse

RequÃªtes itÃ©ratives : 2 (Ã©conomie de 33%)
Temps total : ~100ms
```

### ScÃ©nario 3 : Cache complet (warm cache)

```
RÃ©solution de www.example.com :
(dÃ©jÃ  rÃ©solu rÃ©cemment, en cache)

Client â†’ RÃ©solveur : www.example.com ?
RÃ©solveur (cache) : "Je connais la rÃ©ponse : 93.184.216.34"
RÃ©solveur â†’ Client : 93.184.216.34

RequÃªtes itÃ©ratives : 0 âœ“
Temps total : ~10-20ms (90% plus rapide !)
```

### Impact sur les performances

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Latence selon l'Ã©tat du cache                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ Sans cache (cold)     : â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 150ms          â”‚
â”‚ Cache partiel         : â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100ms                â”‚
â”‚ Cache complet (warm)  : â–ˆâ–ˆ 20ms                         â”‚
â”‚                                                         â”‚
â”‚ Ã‰conomie avec cache : 87% de rÃ©duction du temps !       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## RequÃªtes rÃ©cursives non autorisÃ©es

Certains serveurs DNS **n'autorisent pas** la rÃ©cursion :

### Serveurs autoritaires

Les serveurs autoritaires (racine, TLD, domaines) rÃ©pondent gÃ©nÃ©ralement **uniquement** de maniÃ¨re itÃ©rative :

```bash
# Tentative de requÃªte rÃ©cursive vers un serveur racine
$ dig www.google.com @a.root-servers.net

; <<>> DiG 9.18.24 <<>> www.google.com @a.root-servers.net
;; flags: qr rd; QUERY: 1, ANSWER: 0
           â”‚  â”‚
           â”‚  â””â”€ RD=1 : Client demandait la rÃ©cursion
           â””â”€â”€â”€â”€ Pas de RA : Serveur ne fait PAS de rÃ©cursion

;; AUTHORITY SECTION:
com.                    172800  IN      NS      a.gtld-servers.net.
; ... (rÃ©fÃ©rence vers .com)

Le serveur racine :
âœ— N'a pas fait de rÃ©cursion (pas de RA)
âœ“ A donnÃ© une rÃ©fÃ©rence (itÃ©ratif)
```

### RÃ©solveurs restreints

Certains rÃ©solveurs limitent qui peut faire des requÃªtes rÃ©cursives :

```
Configuration typique d'un rÃ©solveur (BIND) :

options {
    recursion yes;
    allow-recursion {
        192.168.1.0/24;    // RÃ©seau local
        10.0.0.0/8;        // RÃ©seau interne
    };
};

Si vous n'Ãªtes pas dans ces rÃ©seaux :
â†’ Le serveur refuse la rÃ©cursion
â†’ RÃ©ponse : REFUSED
```

**Pourquoi cette restriction ?**
```
Sans restriction :
âœ— Serveur utilisable comme amplificateur DDoS
âœ— Charge importante (toute la planÃ¨te peut l'utiliser)
âœ— Bande passante gaspillÃ©e

Avec restriction :
âœ“ SÃ©curisÃ© contre les abus
âœ“ Charge contrÃ´lÃ©e
âœ“ Seulement les clients lÃ©gitimes
```

### Test de rÃ©cursion ouverte

```bash
# Tester si un serveur autorise la rÃ©cursion
$ dig www.google.com @serveur.example.com

# Si rÃ©cursion refusÃ©e :
;; flags: qr rd; QUERY: 1, ANSWER: 0
           â”‚  â”‚
           â”‚  â””â”€ RD=1 : Vous l'avez demandÃ©
           â””â”€â”€â”€â”€ Pas de RA : Serveur a refusÃ©

;; status: REFUSED  â† RÃ©cursion non autorisÃ©e
```

## Types de rÃ©solveurs

### Stub Resolver (RÃ©solveur minimal)

```
CaractÃ©ristiques :
â€¢ ImplÃ©mentation minimale (sur l'OS)
â€¢ Fait UNIQUEMENT des requÃªtes rÃ©cursives
â€¢ Pas de cache sophistiquÃ©
â€¢ DÃ©pend totalement du rÃ©solveur rÃ©cursif

Exemples :
â€¢ BibliothÃ¨que systÃ¨me (glibc resolver)
â€¢ Code applicatif simple
â€¢ Clients embarquÃ©s
```

### Recursive Resolver (RÃ©solveur rÃ©cursif)

```
CaractÃ©ristiques :
â€¢ Fait le travail complet
â€¢ Cache sophistiquÃ© (multi-niveaux)
â€¢ GÃ¨re les requÃªtes itÃ©ratives
â€¢ Peut implÃ©menter des politiques

Exemples :
â€¢ Google Public DNS (8.8.8.8)
â€¢ Cloudflare DNS (1.1.1.1)
â€¢ BIND, Unbound (serveurs)
â€¢ systemd-resolved (Linux)
```

### Forwarding Resolver (RÃ©solveur de transfert)

```
CaractÃ©ristiques :
â€¢ ReÃ§oit requÃªtes rÃ©cursives
â€¢ Les transfÃ¨re Ã  un autre rÃ©solveur
â€¢ Cache local simple
â€¢ Utile pour centralisation/filtrage

Exemple typique :
Router/Box Internet (192.168.1.1)
    â†“ (transfÃ¨re)
DNS du FAI (X.X.X.X)
    â†“ (rÃ©solution complÃ¨te)
Serveurs autoritaires
```

**Configuration forwarding resolver :**
```
Client â†’ Box (192.168.1.1)
         â””â”€ Forward vers â†’ DNS FAI (212.27.40.240)
                           â””â”€ RÃ©solution itÃ©rative complÃ¨te
```

## Comparaison rÃ©cursif vs itÃ©ratif

### Tableau comparatif

| Aspect | RÃ©cursif | ItÃ©ratif |
|--------|----------|----------|
| **Qui l'utilise** | Client â†’ RÃ©solveur | RÃ©solveur â†’ Serveurs |
| **Travail** | Serveur fait tout | Client fait le travail |
| **RÃ©ponse** | RÃ©ponse finale complÃ¨te | RÃ©fÃ©rence ou rÃ©ponse |
| **RequÃªtes** | Une seule du client | Plusieurs successives |
| **Charge** | Lourde pour le serveur | LÃ©gÃ¨re pour chaque serveur |
| **Cache** | Essentiel (performance) | Moins critique |
| **ComplexitÃ©** | Simple pour client | Complexe pour client |
| **Flag DNS** | RD=1, RA=1 | RD=0, pas de RA |
| **ScalabilitÃ©** | LimitÃ©e (goulet) | Excellente (distribuÃ©e) |

### Temps de rÃ©solution

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Comparaison des temps (sans cache)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ RÃ‰CURSIF (client â†’ rÃ©solveur) :                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚ â”‚ 150ms  â”‚ Une seule requÃªte client                      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚                                                          â”‚
â”‚ ITÃ‰RATIF (si client le faisait lui-mÃªme) :               â”‚
â”‚ â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”                                        â”‚
â”‚ â”‚50 â”‚+â”‚50 â”‚+â”‚50 â”‚ = 150ms (3 requÃªtes successives)       â”‚
â”‚ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜                                        â”‚
â”‚  â†‘     â†‘     â†‘                                           â”‚
â”‚  â”‚     â”‚     â””â”€ Serveur autoritaire                      â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€ Serveur TLD                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Serveur racine                           â”‚
â”‚                                                          â”‚
â”‚ Temps similaire, mais :                                  â”‚
â”‚ â€¢ RÃ©cursif : Simple pour le client                       â”‚
â”‚ â€¢ ItÃ©ratif : ContrÃ´le total mais complexe                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Cas d'usage pratiques

### Quand utiliser la rÃ©solution rÃ©cursive ?

```
âœ… Applications client (navigateur, email)
âœ… Serveurs applicatifs
âœ… Conteneurs et microservices
âœ… Appareils IoT
âœ… Clients mobiles

Raison : SimplicitÃ© et efficacitÃ© via cache
```

### Quand utiliser la rÃ©solution itÃ©rative ?

```
âœ… ImplÃ©mentation d'un rÃ©solveur rÃ©cursif
âœ… Outils de diagnostic DNS (dig +trace)
âœ… Monitoring et vÃ©rification DNS
âœ… Contourner un rÃ©solveur dÃ©faillant
âœ… Tests de sÃ©curitÃ© DNS

Raison : ContrÃ´le total du processus
```

### Cas hybride : RÃ©solveur de transfert

```
RÃ©seau d'entreprise typique :

Postes clients
    â†“ (rÃ©cursif)
RÃ©solveur local (192.168.1.10)
    â”œâ”€ Cache local
    â”œâ”€ RÃ¨gles de filtrage
    â””â”€ Forward vers â†’ RÃ©solveurs publics (8.8.8.8)
                      â†“ (itÃ©ratif)
                      Serveurs autoritaires

Avantages :
âœ“ ContrÃ´le centralisÃ©
âœ“ Filtrage de contenu
âœ“ Logs centralisÃ©s
âœ“ Cache partagÃ©
```

## Diagnostic et dÃ©pannage

### VÃ©rifier le type de rÃ©solution

**1. VÃ©rifier si un serveur fait de la rÃ©cursion :**
```bash
# RequÃªte avec rÃ©cursion dÃ©sirÃ©e
$ dig www.google.com @8.8.8.8

# Regarder les flags :
;; flags: qr rd ra
           â”‚  â”‚  â”‚
           â”‚  â”‚  â””â”€ RA=1 : RÃ©cursion disponible âœ“
           â”‚  â””â”€â”€â”€â”€ RD=1 : RÃ©cursion demandÃ©e
           â””â”€â”€â”€â”€â”€â”€â”€ QR=1 : C'est une rÃ©ponse
```

**2. VÃ©rifier si un serveur refuse la rÃ©cursion :**
```bash
$ dig www.google.com @serveur-autoritaire.example.com

# Si refus :
;; flags: qr rd
           â”‚  â”‚
           â”‚  â””â”€ RD=1 : DemandÃ©e
           â””â”€â”€â”€â”€ Pas de RA : RefusÃ©e âœ—

;; status: REFUSED
```

**3. Forcer une requÃªte itÃ©rative :**
```bash
# +norecurse dÃ©sactive le bit RD
$ dig www.google.com @8.8.8.8 +norecurse

# Le rÃ©solveur ne fera pas de rÃ©cursion
# Il donnera juste ce qu'il a en cache ou une rÃ©fÃ©rence
```

### Tracer le chemin de rÃ©solution

```bash
# Trace complÃ¨te (simule la rÃ©solution itÃ©rative)
$ dig +trace www.example.com

# RÃ©sultat : Montre chaque Ã©tape
# 1. Serveurs racine
# 2. Serveurs TLD
# 3. Serveurs autoritaires
# 4. RÃ©ponse finale

# Utile pour :
âœ“ Diagnostiquer les dÃ©lÃ©gations
âœ“ Trouver oÃ¹ la rÃ©solution Ã©choue
âœ“ VÃ©rifier la configuration DNS
âœ“ Comprendre le chemin complet
```

### ProblÃ¨mes courants

**ProblÃ¨me 1 : Timeout sur rÃ©solution rÃ©cursive**
```
SymptÃ´me :
$ dig www.example.com @8.8.8.8
; connection timed out; no servers could be reached

Causes possibles :
1. Pare-feu bloque le port 53 UDP/TCP
2. RÃ©solveur surchargÃ© ou en panne
3. ProblÃ¨me rÃ©seau (routage, perte de paquets)

Diagnostic :
$ ping 8.8.8.8  # VÃ©rifier connectivitÃ© de base
$ traceroute 8.8.8.8  # VÃ©rifier le chemin
$ dig @1.1.1.1  # Essayer un autre rÃ©solveur
```

**ProblÃ¨me 2 : RÃ©solution incomplÃ¨te (SERVFAIL)**
```
SymptÃ´me :
$ dig www.example.com @8.8.8.8
;; status: SERVFAIL

Causes possibles :
1. Serveur autoritaire ne rÃ©pond pas
2. DNSSEC Ã©choue la validation
3. Configuration DNS incorrecte (NS invalides)
4. Boucle de dÃ©lÃ©gation

Diagnostic :
$ dig +trace www.example.com  # Voir oÃ¹ Ã§a bloque
$ dig www.example.com +dnssec  # VÃ©rifier DNSSEC
$ dig www.example.com @serveur-autoritaire  # Test direct
```

**ProblÃ¨me 3 : RÃ©ponses diffÃ©rentes selon le rÃ©solveur**
```
SymptÃ´me :
$ dig www.example.com @8.8.8.8
; RÃ©pond : 93.184.216.34

$ dig www.example.com @1.1.1.1
; RÃ©pond : 93.184.216.35

Causes possibles :
1. DNS load balancing (normal)
2. Cache diffÃ©rent (TTL expirÃ© sur l'un)
3. DNS menteur / manipulation
4. Geo-DNS (rÃ©ponses diffÃ©rentes par rÃ©gion)

Diagnostic :
$ dig www.example.com @serveur-autoritaire
# Comparer avec la source de vÃ©ritÃ©
```

## Optimisations modernes

### Pipelining DNS

Certains rÃ©solveurs modernes envoient plusieurs requÃªtes en parallÃ¨le :

```
RÃ©solution sÃ©quentielle traditionnelle :
â”Œâ”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”
â”‚Root â”‚â”€â”€â”€â”€â”€â”€â”‚ TLD â”‚â”€â”€â”€â”€â”€â”€â”‚Auth â”‚  = 150ms
â””â”€â”€â”€â”€â”€â”˜ 50ms â””â”€â”€â”€â”€â”€â”˜ 50ms â””â”€â”€â”€â”€â”€â”˜ 50ms

RÃ©solution parallÃ¨le optimisÃ©e :
â”Œâ”€â”€â”€â”€â”€â”
â”‚Root â”‚â”€â”€â”
â””â”€â”€â”€â”€â”€â”˜  â”‚
         â”œâ”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â”‚ TLD â”‚â”€â”€â”
         â”‚     â””â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”
         â”‚              â””â”€â”€â”‚Auth â”‚  = 70ms
         â”‚                 â””â”€â”€â”€â”€â”€â”˜
         â””â”€ RequÃªtes en parallÃ¨le quand possible

Gain : 53% plus rapide !
```

### Prefetching

Certains rÃ©solveurs prÃ©chargent les enregistrements avant expiration :

```
Enregistrement en cache :
TTL : 3600s (1 heure)

Ã€ t+3300s (5 minutes avant expiration) :
RÃ©solveur rafraÃ®chit automatiquement en arriÃ¨re-plan
â””â”€ Pas d'attente pour le prochain client !

Avantage :
â€¢ Cache toujours "chaud"
â€¢ Pas de latence de re-rÃ©solution
â€¢ ExpÃ©rience utilisateur fluide
```

### Query Minimization (qname minimization)

Protocole de confidentialitÃ© - ne rÃ©vÃ©ler que le minimum nÃ©cessaire :

```
Traditionnel :
Client veut : www.blog.example.com

RÃ©solveur â†’ Racine : "OÃ¹ est www.blog.example.com ?"
    â””â”€ Racine voit tout le nom (problÃ¨me de vie privÃ©e)

Avec Query Minimization (RFC 7816) :
RÃ©solveur â†’ Racine : "OÃ¹ est .com ?"
RÃ©solveur â†’ .com : "OÃ¹ est example.com ?"
RÃ©solveur â†’ example.com : "OÃ¹ est blog.example.com ?"
RÃ©solveur â†’ blog.example.com : "OÃ¹ est www.blog.example.com ?"

â””â”€ Chaque serveur ne voit que ce qui le concerne âœ“
```

## Points clÃ©s Ã  retenir

ğŸ”‘ **RÃ©cursif** : "Fais tout le travail pour moi" - UtilisÃ© par les clients

ğŸ”‘ **ItÃ©ratif** : "Donne-moi une rÃ©fÃ©rence" - UtilisÃ© entre serveurs DNS

ğŸ”‘ **Le client fait du rÃ©cursif vers le rÃ©solveur**

ğŸ”‘ **Le rÃ©solveur fait de l'itÃ©ratif vers les serveurs autoritaires**

ğŸ”‘ **Flag RD=1 indique une demande de rÃ©cursion**

ğŸ”‘ **Flag RA=1 indique que la rÃ©cursion a Ã©tÃ© effectuÃ©e**

ğŸ”‘ **Le cache rÃ©duit drastiquement le nombre de requÃªtes (87% du temps)**

ğŸ”‘ **Sans cache : 3 requÃªtes itÃ©ratives (racine â†’ TLD â†’ autoritaire)**

ğŸ”‘ **Les serveurs autoritaires ne font gÃ©nÃ©ralement pas de rÃ©cursion**

ğŸ”‘ **dig +trace simule la rÃ©solution itÃ©rative Ã©tape par Ã©tape**

---

## Ce que nous avons appris

Dans cette section, nous avons explorÃ© en dÃ©tail :

- âœ… La diffÃ©rence entre rÃ©solution rÃ©cursive et itÃ©rative
- âœ… Les rÃ´les de chaque acteur (client, rÃ©solveur, serveurs)
- âœ… Le processus complet de rÃ©solution (avec tous les dÃ©tails)
- âœ… L'impact crucial du cache sur les performances
- âœ… Les flags DNS (RD, RA, AA) et leur signification
- âœ… Comment utiliser dig pour diagnostiquer
- âœ… Les diffÃ©rents types de rÃ©solveurs
- âœ… Les cas d'usage pratiques de chaque mode
- âœ… Les optimisations modernes (pipelining, prefetching)
- âœ… Le dÃ©pannage des problÃ¨mes de rÃ©solution

## Pour aller plus loin

Maintenant que vous comprenez les mÃ©canismes de rÃ©solution DNS, nous allons approfondir le fonctionnement du **cache DNS et du TTL** : comment ils fonctionnent en dÃ©tail, comment les configurer, et leur impact sur les performances et la propagation des changements DNS.

---

**Prochaine section : Cache DNS et TTL** ğŸ‘‰

â­ï¸ [Cache DNS et TTL](/05-couche-application/02.4-dns-cache-ttl.md)
