ğŸ” Retour au [Sommaire](/SOMMAIRE.md)

# 5.2.1 Architecture hiÃ©rarchique du DNS

## Introduction

L'architecture DNS repose sur un principe simple mais puissant : une **hiÃ©rarchie en arbre inversÃ©** oÃ¹ chaque niveau dÃ©lÃ¨gue la responsabilitÃ© au niveau infÃ©rieur. Cette organisation permet Ã  DNS de gÃ©rer des milliards de noms de domaine de maniÃ¨re distribuÃ©e, scalable et rÃ©siliente.

Contrairement au systÃ¨me centralisÃ© de fichiers HOSTS.TXT des dÃ©buts d'Internet, DNS n'a **pas de point unique de dÃ©faillance**. Aucune organisation ne contrÃ´le l'intÃ©gralitÃ© du systÃ¨me, et pourtant tout fonctionne de maniÃ¨re cohÃ©rente grÃ¢ce Ã  cette architecture hiÃ©rarchique.

## Vue d'ensemble de la hiÃ©rarchie

### L'arbre DNS

```
                         . (racine)
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚               â”‚              â”‚          â”‚
          .com            .org           .net        .fr
            â”‚               â”‚              â”‚          â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”
     â”‚             â”‚   â”‚         â”‚    â”‚        â”‚  â”‚       â”‚
  google      amazon  wikipedia  â”‚  cloudflare  gouv   free
     â”‚             â”‚       â”‚     â”‚     â”‚       â”‚       â”‚
  â”Œâ”€â”€â”´â”€â”€â”          â”‚       â”‚     â”‚     â”‚       â”‚       â”‚
  â”‚     â”‚          â”‚       â”‚     â”‚     â”‚       â”‚       â”‚
 www   mail       www     fr    en    www     www     www
                   â”‚
                   â”œâ”€ en
                   â””â”€ fr
```

**Lecture de la hiÃ©rarchie :**
- **Du haut vers le bas** : DÃ©lÃ©gation de l'autoritÃ©
- **Du bas vers le haut** : Construction d'un nom de domaine complet (FQDN)

**Exemple de construction d'un FQDN :**
```
www.google.com.
â”‚   â”‚      â”‚   â”‚
â”‚   â”‚      â”‚   â””â”€ Racine (.)
â”‚   â”‚      â””â”€â”€â”€â”€â”€ TLD (.com)
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Domaine (google)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Sous-domaine/hÃ´te (www)

Chemin dans l'arbre :
. (racine) â†’ .com â†’ google â†’ www
```

### Niveaux de la hiÃ©rarchie

| Niveau | Nom | Exemple | GÃ©rÃ© par |
|--------|-----|---------|----------|
| **0** | Racine | `.` | IANA / ICANN |
| **1** | TLD (Top Level Domain) | `.com`, `.org`, `.fr` | Registres (Verisign, Afnic...) |
| **2** | Second Level Domain | `google.com`, `example.org` | PropriÃ©taires de domaines |
| **3+** | Sous-domaines | `www.google.com`, `mail.example.org` | PropriÃ©taires de domaines |

## Les serveurs racine (Root Servers)

### RÃ´le et importance

Les **serveurs racine** sont au sommet de la hiÃ©rarchie DNS. Ils ne rÃ©solvent pas directement les noms de domaine, mais **indiquent oÃ¹ trouver les serveurs TLD**.

```
Question : "OÃ¹ trouver www.google.com ?"
Serveur racine : "Je ne sais pas, mais demande aux serveurs .com"
                 "Voici leurs adresses : a.gtld-servers.net, etc."
```

**ResponsabilitÃ© des serveurs racine :**
- ConnaÃ®tre les serveurs autoritaires de tous les TLD
- RÃ©pondre aux requÃªtes concernant les TLD
- Servir de point d'entrÃ©e pour toute rÃ©solution DNS

### Les 13 serveurs racine

Il existe **13 adresses IP** de serveurs racine, identifiÃ©es de **A Ã  M** :

```
Serveurs racine DNS

a.root-servers.net    198.41.0.4       (Verisign)
b.root-servers.net    199.9.14.201     (USC-ISI)
c.root-servers.net    192.33.4.12      (Cogent)
d.root-servers.net    199.7.91.13      (University of Maryland)
e.root-servers.net    192.203.230.10   (NASA)
f.root-servers.net    192.5.5.241      (ISC)
g.root-servers.net    192.112.36.4     (US DoD)
h.root-servers.net    198.97.190.53    (US Army)
i.root-servers.net    192.36.148.17    (Netnod)
j.root-servers.net    192.58.128.30    (Verisign)
k.root-servers.net    193.0.14.129     (RIPE NCC)
l.root-servers.net    199.7.83.42      (ICANN)
m.root-servers.net    202.12.27.33     (WIDE Project)
```

### RÃ©partition gÃ©ographique via Anycast

**Mythe :** Il n'y a que 13 serveurs physiques.

**RÃ©alitÃ© :** Il y a **plus de 1000 instances physiques** distribuÃ©es dans le monde entier grÃ¢ce Ã  la technologie **Anycast**.

```
Principe Anycast :

MÃªme adresse IP annoncÃ©e depuis plusieurs emplacements

Utilisateur Ã  Paris interroge 198.41.0.4 (a.root-servers.net)
  â†’ RoutÃ© vers l'instance la plus proche (peut-Ãªtre Amsterdam)

Utilisateur Ã  Tokyo interroge 198.41.0.4 (a.root-servers.net)
  â†’ RoutÃ© vers l'instance la plus proche (peut-Ãªtre Tokyo)

MÃªme IP, serveurs physiques diffÃ©rents !
```

**Distribution mondiale (exemple pour a.root-servers.net) :**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a.root-servers.net (198.41.0.4)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ New York, USA                                     â”‚
â”‚ â€¢ Los Angeles, USA                                  â”‚
â”‚ â€¢ Miami, USA                                        â”‚
â”‚ â€¢ Londres, UK                                       â”‚
â”‚ â€¢ Amsterdam, Pays-Bas                               â”‚
â”‚ â€¢ Paris, France                                     â”‚
â”‚ â€¢ Francfort, Allemagne                              â”‚
â”‚ â€¢ Tokyo, Japon                                      â”‚
â”‚ â€¢ Sydney, Australie                                 â”‚
â”‚ â€¢ SÃ£o Paulo, BrÃ©sil                                 â”‚
â”‚ â€¢ ... et plus de 150 autres emplacements            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Avantages de cette distribution :**
- âœ… Latence minimale (serveur proche)
- âœ… Haute disponibilitÃ© (redondance)
- âœ… RÃ©silience aux attaques DDoS
- âœ… Pas de point unique de dÃ©faillance

### Contenu de la zone racine

La zone racine contient les enregistrements NS des TLD :

```
; Extrait simplifiÃ© de la zone racine (root zone file)

.                       518400  IN  NS  a.root-servers.net.
.                       518400  IN  NS  b.root-servers.net.
.                       518400  IN  NS  c.root-servers.net.
; ... (13 serveurs au total)

; DÃ©lÃ©gation pour .com
com.                    172800  IN  NS  a.gtld-servers.net.
com.                    172800  IN  NS  b.gtld-servers.net.
com.                    172800  IN  NS  c.gtld-servers.net.
; ... (13 serveurs pour .com)

; DÃ©lÃ©gation pour .org
org.                    172800  IN  NS  a0.org.afilias-nst.info.
org.                    172800  IN  NS  a2.org.afilias-nst.info.
; ...

; DÃ©lÃ©gation pour .fr
fr.                     172800  IN  NS  d.nic.fr.
fr.                     172800  IN  NS  e.ext.nic.fr.
fr.                     172800  IN  NS  f.ext.nic.fr.
; ...

; Enregistrements additionnels (glue records)
a.gtld-servers.net.     172800  IN  A   192.5.6.30
a.gtld-servers.net.     172800  IN  AAAA 2001:503:a83e::2:30
```

**Note importante :** La zone racine contient environ **1 500 TLD** actuellement.

### Interroger directement un serveur racine

Vous pouvez interroger un serveur racine vous-mÃªme :

```bash
# Interroger a.root-servers.net pour obtenir les serveurs .com
dig @a.root-servers.net com NS

# RÃ©ponse (simplifiÃ©e) :
; QUESTION SECTION:
;com.                           IN      NS

; AUTHORITY SECTION:
com.                    172800  IN      NS      a.gtld-servers.net.
com.                    172800  IN      NS      b.gtld-servers.net.
com.                    172800  IN      NS      c.gtld-servers.net.
; ... (13 serveurs au total)

; ADDITIONAL SECTION (glue records):
a.gtld-servers.net.     172800  IN      A       192.5.6.30
a.gtld-servers.net.     172800  IN      AAAA    2001:503:a83e::2:30
```

## Les serveurs TLD (Top Level Domain)

### Types de TLD

Les domaines de premier niveau sont organisÃ©s en plusieurs catÃ©gories :

#### 1. gTLD gÃ©nÃ©riques (Generic TLD)
```
Originaux (annÃ©es 1980) :
.com    Commercial (mais ouvert Ã  tous)
.org    Organisations (mais ouvert Ã  tous)
.net    RÃ©seaux (mais ouvert Ã  tous)
.edu    Ã‰ducation (US uniquement, restreint)
.gov    Gouvernement US (restreint)
.mil    Militaire US (restreint)
.int    Organisations internationales (restreint)

Nouveaux gTLD (depuis 2013) :
.app, .dev, .blog, .shop, .tech, .online, .site
.google, .amazon, .apple (branded TLD)
.paris, .london, .tokyo (geo TLD)
... plus de 1 200 nouveaux gTLD !
```

#### 2. ccTLD (Country Code TLD)
```
Codes pays ISO 3166 :
.fr     France (gÃ©rÃ© par Afnic)
.de     Allemagne (gÃ©rÃ© par DENIC)
.uk     Royaume-Uni (gÃ©rÃ© par Nominet)
.jp     Japon (gÃ©rÃ© par JPRS)
.cn     Chine (gÃ©rÃ© par CNNIC)
.us     Ã‰tats-Unis (gÃ©rÃ© par Neustar)
.ca     Canada (gÃ©rÃ© par CIRA)

Total : 250+ ccTLD (un par pays/territoire)
```

#### 3. sTLD spÃ©cialisÃ©s (Sponsored TLD)
```
.aero   Industrie aÃ©ronautique
.coop   CoopÃ©ratives
.museum MusÃ©es
.travel Industrie du voyage
```

### OpÃ©rateurs de TLD (Registres)

Chaque TLD est gÃ©rÃ© par un **registre** (registry) sous contrat avec l'ICANN :

| TLD | Registre | OpÃ©rateur |
|-----|----------|-----------|
| .com, .net | Verisign | Entreprise privÃ©e (USA) |
| .org | Public Interest Registry | Organisation Ã  but non lucratif |
| .fr | Afnic | Association (France) |
| .uk | Nominet | Entreprise Ã  but non lucratif (UK) |
| .de | DENIC | CoopÃ©rative (Allemagne) |

**ResponsabilitÃ©s d'un registre :**
- Maintenir les serveurs DNS autoritaires du TLD
- GÃ©rer la base de donnÃ©es des domaines enregistrÃ©s
- DÃ©finir les politiques d'enregistrement
- Interface avec les bureaux d'enregistrement (registrars)

### Architecture d'un TLD

Prenons l'exemple de **.com** (gÃ©rÃ© par Verisign) :

```
Zone .com

Serveurs NS autoritaires :
â”œâ”€ a.gtld-servers.net.  192.5.6.30
â”œâ”€ b.gtld-servers.net.  192.33.14.30
â”œâ”€ c.gtld-servers.net.  192.26.92.30
â”œâ”€ d.gtld-servers.net.  192.31.80.30
â”œâ”€ e.gtld-servers.net.  192.12.94.30
â”œâ”€ f.gtld-servers.net.  192.35.51.30
â”œâ”€ g.gtld-servers.net.  192.42.93.30
â”œâ”€ h.gtld-servers.net.  192.54.112.30
â”œâ”€ i.gtld-servers.net.  192.43.172.30
â”œâ”€ j.gtld-servers.net.  192.48.79.30
â”œâ”€ k.gtld-servers.net.  192.52.178.30
â”œâ”€ l.gtld-servers.net.  192.41.162.30
â””â”€ m.gtld-servers.net.  192.55.83.30

Chaque serveur est "anycastÃ©" depuis plusieurs emplacements
Total : 150+ instances physiques dans le monde
```

**Contenu de la zone .com (extrait simplifiÃ©) :**
```
; Zone .com - DÃ©lÃ©gations vers domaines

google.com.         172800  IN  NS  ns1.google.com.
google.com.         172800  IN  NS  ns2.google.com.
google.com.         172800  IN  NS  ns3.google.com.
google.com.         172800  IN  NS  ns4.google.com.

; Glue records (nÃ©cessaires car NS dans le mÃªme domaine)
ns1.google.com.     172800  IN  A   216.239.32.10
ns2.google.com.     172800  IN  A   216.239.34.10
ns3.google.com.     172800  IN  A   216.239.36.10
ns4.google.com.     172800  IN  A   216.239.38.10

amazon.com.         172800  IN  NS  ns1.p31.dynect.net.
amazon.com.         172800  IN  NS  ns2.p31.dynect.net.
amazon.com.         172800  IN  NS  ns3.p31.dynect.net.
amazon.com.         172800  IN  NS  ns4.p31.dynect.net.

; Pas de glue records (NS dans un autre domaine)

; ... des millions d'entrÃ©es similaires
```

### Interroger un serveur TLD

```bash
# Interroger un serveur .com pour obtenir les NS de google.com
dig @a.gtld-servers.net google.com NS

# RÃ©ponse (simplifiÃ©e) :
; QUESTION SECTION:
;google.com.                    IN      NS

; AUTHORITY SECTION:
google.com.             172800  IN      NS      ns1.google.com.
google.com.             172800  IN      NS      ns2.google.com.
google.com.             172800  IN      NS      ns3.google.com.
google.com.             172800  IN      NS      ns4.google.com.

; ADDITIONAL SECTION (glue records):
ns1.google.com.         172800  IN      A       216.239.32.10
ns2.google.com.         172800  IN      A       216.239.34.10
```

## Les serveurs autoritaires

### DÃ©finition et rÃ´le

Un serveur **autoritaire** (authoritative server) est le serveur DNS qui possÃ¨de les **informations officielles** pour une zone DNS particuliÃ¨re.

```
Analogie : Registre d'Ã©tat civil

Vous voulez savoir la date de naissance de quelqu'un :
â€¢ Vous pouvez demander Ã  des connaissances (cache DNS)
â€¢ Mais seul le registre d'Ã©tat civil est autoritaire

Serveur autoritaire = Source de vÃ©ritÃ© pour un domaine
```

**CaractÃ©ristiques d'un serveur autoritaire :**
- Contient la zone DNS complÃ¨te du domaine
- RÃ©pond sans consulter d'autres serveurs
- Flag "AA" (Authoritative Answer) dans les rÃ©ponses
- DÃ©fini dans les enregistrements NS du domaine

### Types de serveurs autoritaires

#### Serveur primaire (Master/Primary)
```
RÃ´le :
â€¢ Contient la version originale de la zone
â€¢ C'est ici que les modifications sont faites
â€¢ Source pour les serveurs secondaires

Aussi appelÃ© : Master server, Primary server
```

#### Serveur secondaire (Slave/Secondary)
```
RÃ´le :
â€¢ RÃ©plique du serveur primaire
â€¢ Obtient la zone par transfert (AXFR/IXFR)
â€¢ Peut rÃ©pondre aux requÃªtes
â€¢ Prend le relais si le primaire est indisponible

Aussi appelÃ© : Slave server, Secondary server
```

**Configuration typique :**
```
example.com.

Serveur primaire :
â€¢ ns1.example.com (203.0.113.10) - Master

Serveurs secondaires :
â€¢ ns2.example.com (203.0.113.11) - Slave
â€¢ ns3.example.com (198.51.100.10) - Slave (autre rÃ©seau)
â€¢ ns4.example.com (192.0.2.10) - Slave (autre localisation)
```

### Fichier de zone

Un serveur autoritaire maintient un **fichier de zone** pour chaque domaine gÃ©rÃ©.

**Exemple de fichier de zone complet (example.com) :**
```
; Zone file for example.com
$TTL 86400      ; TTL par dÃ©faut : 24 heures
$ORIGIN example.com.

; SOA (Start of Authority) - Informations de la zone
@       IN  SOA ns1.example.com. admin.example.com. (
            2024120601  ; Serial (YYYYMMDDnn)
            3600        ; Refresh (1 heure)
            1800        ; Retry (30 minutes)
            604800      ; Expire (1 semaine)
            86400 )     ; Minimum TTL (24 heures)

; Serveurs de noms (NS records)
        IN  NS  ns1.example.com.
        IN  NS  ns2.example.com.
        IN  NS  ns3.example.com.

; Enregistrements A/AAAA (IPv4/IPv6)
@       IN  A       93.184.216.34
@       IN  AAAA    2606:2800:220:1:248:1893:25c8:1946
www     IN  A       93.184.216.34
www     IN  AAAA    2606:2800:220:1:248:1893:25c8:1946

; Serveurs de noms (avec leurs IPs)
ns1     IN  A       203.0.113.10
ns2     IN  A       203.0.113.11
ns3     IN  A       198.51.100.10

; Serveur de messagerie (MX records)
@       IN  MX  10  mail.example.com.
@       IN  MX  20  mail2.example.com.

; Serveurs de mail
mail    IN  A       93.184.216.50
mail2   IN  A       93.184.216.51

; Services divers
ftp     IN  A       93.184.216.60
blog    IN  CNAME   www.example.com.
shop    IN  CNAME   shopify.example.com.

; Enregistrements TXT (SPF, DKIM, vÃ©rification domaine)
@       IN  TXT     "v=spf1 mx ~all"
@       IN  TXT     "google-site-verification=abc123..."
_dmarc  IN  TXT     "v=DMARC1; p=quarantine; rua=mailto:dmarc@example.com"

; SRV records (services)
_sip._tcp   IN  SRV 10 60 5060 sipserver.example.com.
```

**Explication du SOA (Start of Authority) :**
```
SOA contient les mÃ©tadonnÃ©es de la zone :

Serial (2024120601) :
â€¢ NumÃ©ro de version de la zone
â€¢ IncrÃ©mentÃ© Ã  chaque modification
â€¢ Format : YYYYMMDDnn (annÃ©e, mois, jour, version du jour)
â€¢ Les secondaires vÃ©rifient ce numÃ©ro pour savoir s'ils doivent se mettre Ã  jour

Refresh (3600 = 1h) :
â€¢ Intervalle auquel les secondaires vÃ©rifient les mises Ã  jour

Retry (1800 = 30min) :
â€¢ Si Ã©chec du refresh, rÃ©essayer aprÃ¨s ce dÃ©lai

Expire (604800 = 1 semaine) :
â€¢ Si impossible de contacter le primaire pendant ce dÃ©lai,
  les secondaires arrÃªtent de rÃ©pondre pour cette zone

Minimum TTL (86400 = 24h) :
â€¢ TTL par dÃ©faut pour les rÃ©ponses nÃ©gatives (NXDOMAIN)
```

### Transfert de zone

Les serveurs secondaires obtiennent la zone via des **transferts de zone**.

#### AXFR (Full Zone Transfer)
```
Serveur secondaire â†’ Serveur primaire (TCP port 53)
"Donne-moi la zone complÃ¨te example.com"

Serveur primaire â†’ Serveur secondaire
[Envoie TOUS les enregistrements de la zone]

UtilisÃ© pour :
â€¢ Initialisation d'un nouveau secondaire
â€¢ AprÃ¨s une panne longue
â€¢ Configuration manuelle
```

**Exemple de commande :**
```bash
# Demander un transfert de zone complet
dig @ns1.example.com example.com AXFR

# RÃ©ponse : tous les enregistrements de la zone
; <<>> DiG 9.18.24 <<>> @ns1.example.com example.com AXFR
example.com.            86400   IN      SOA     ns1.example.com. ...
example.com.            86400   IN      NS      ns1.example.com.
example.com.            86400   IN      NS      ns2.example.com.
example.com.            86400   IN      A       93.184.216.34
www.example.com.        86400   IN      A       93.184.216.34
mail.example.com.       86400   IN      A       93.184.216.50
; ... tous les autres enregistrements
example.com.            86400   IN      SOA     ns1.example.com. ...
```

**SÃ©curitÃ© AXFR :**
La plupart des serveurs DNS restreignent les transferts de zone :
```
; Configuration BIND (serveur primaire)
zone "example.com" {
    type master;
    file "/etc/bind/zones/example.com";

    // Autoriser les transferts uniquement vers les secondaires
    allow-transfer {
        203.0.113.11;  // ns2
        198.51.100.10; // ns3
    };
};
```

#### IXFR (Incremental Zone Transfer)
```
Serveur secondaire â†’ Serveur primaire
"Mon serial est 2024120501, as-tu des mises Ã  jour ?"

Serveur primaire â†’ Serveur secondaire
"Oui, voici uniquement les modifications depuis ce serial"

Avantages :
â€¢ Transfert uniquement des changements
â€¢ Moins de bande passante
â€¢ Plus rapide
```

### Interroger un serveur autoritaire

```bash
# Interroger directement le serveur autoritaire de google.com
dig @ns1.google.com www.google.com A

# RÃ©ponse avec flag "aa" (authoritative answer) :
; <<>> DiG 9.18.24 <<>> @ns1.google.com www.google.com A
;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
         â†‘
         aa = authoritative answer (rÃ©ponse autoritaire)

;; ANSWER SECTION:
www.google.com.         300     IN      A       142.250.185.196
```

**DiffÃ©rence avec un rÃ©solveur :**
```
RÃ©solveur rÃ©cursif (8.8.8.8) :
;; flags: qr rd ra; QUERY: 1, ANSWER: 1
         â†‘  â†‘  â†‘
         â”‚  â”‚  â””â”€ ra = recursion available
         â”‚  â””â”€â”€â”€â”€ rd = recursion desired
         â””â”€â”€â”€â”€â”€â”€â”€ qr = query response
(Pas de flag "aa" car il a obtenu la rÃ©ponse d'ailleurs)

Serveur autoritaire (ns1.google.com) :
;; flags: qr aa rd; QUERY: 1, ANSWER: 1
         â†‘  â†‘
         â”‚  â””â”€â”€â”€â”€ aa = authoritative answer
         â””â”€â”€â”€â”€â”€â”€â”€ qr = query response
(Flag "aa" prÃ©sent car c'est la source de vÃ©ritÃ©)
```

## Les rÃ©solveurs rÃ©cursifs

### RÃ´le et fonctionnement

Le **rÃ©solveur rÃ©cursif** (recursive resolver) est l'intermÃ©diaire entre les clients et les serveurs DNS autoritaires.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RÃ©solveur rÃ©cursif = "Agent de rÃ©solution"              â”‚
â”‚                                                         â”‚
â”‚ Il fait tout le travail pour le client :                â”‚
â”‚ 1. ReÃ§oit la requÃªte du client                          â”‚
â”‚ 2. VÃ©rifie son cache                                    â”‚
â”‚ 3. Si pas en cache, interroge la hiÃ©rarchie DNS         â”‚
â”‚ 4. Met en cache le rÃ©sultat                             â”‚
â”‚ 5. RÃ©pond au client                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### RÃ©solveurs publics populaires

| Fournisseur | Adresses IP | CaractÃ©ristiques |
|-------------|-------------|------------------|
| **Google Public DNS** | 8.8.8.8 / 8.8.4.4 | Rapide, anycastÃ© mondial |
| **Cloudflare DNS** | 1.1.1.1 / 1.0.0.1 | AxÃ© sur la vie privÃ©e |
| **Quad9** | 9.9.9.9 / 149.112.112.112 | Blocage de malware |
| **OpenDNS** | 208.67.222.222 / 208.67.220.220 | Filtrage de contenu |

### RÃ©solveurs locaux vs publics

#### RÃ©solveur local (FAI)
```
Configuration automatique via DHCP :
â€¢ DNS : 192.168.1.1 (box Internet)
â€¢ La box transfÃ¨re vers le rÃ©solveur du FAI

Avantages :
âœ“ Configuration automatique
âœ“ Peut-Ãªtre lÃ©gÃ¨rement plus rapide (local)

InconvÃ©nients :
âœ— Performance variable
âœ— Peut loguer les requÃªtes
âœ— Peut bloquer certains sites
âœ— Moins fiable
```

#### RÃ©solveur public
```
Configuration manuelle :
â€¢ DNS : 8.8.8.8 (Google) ou 1.1.1.1 (Cloudflare)

Avantages :
âœ“ Performance gÃ©nÃ©ralement excellente
âœ“ DisponibilitÃ© Ã©levÃ©e (anycast mondial)
âœ“ Politiques de confidentialitÃ© claires

InconvÃ©nients :
âœ— Configuration manuelle
âœ— Le fournisseur voit vos requÃªtes DNS
```

### Processus de rÃ©solution rÃ©cursive complet

Visualisons un exemple complet de rÃ©solution pour `www.example.com` :

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 0 : Client envoie la requÃªte                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ordinateur (192.168.1.100)
    â”‚
    â”‚ RequÃªte DNS : "Quelle est l'IP de www.example.com ?"
    â”‚ UDP, port 53
    â”‚
    â””â”€â”€â”€â”€â”€â†’ RÃ©solveur rÃ©cursif (8.8.8.8)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 1 : VÃ©rification du cache                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur (8.8.8.8)
    â”‚
    â”‚ VÃ©rifie cache : www.example.com ?
    â”‚ â””â”€ Pas trouvÃ© (ou expirÃ©)
    â”‚
    â”‚ Lance une rÃ©solution itÃ©rative...

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 2 : Interrogation serveur racine                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur (8.8.8.8)
    â”‚
    â”‚ "OÃ¹ est www.example.com ?"
    â”‚
    â””â”€â”€â”€â”€â”€â†’ Serveur racine (198.41.0.4) [a.root-servers.net]

Serveur racine
    â”‚
    â”‚ "Je ne sais pas www.example.com,"
    â”‚ "mais voici les serveurs pour .com :"
    â”‚
    â”‚ NS: a.gtld-servers.net (192.5.6.30)
    â”‚ NS: b.gtld-servers.net (192.33.14.30)
    â”‚ ...
    â”‚
    â””â”€â”€â”€â”€â”€â†’ RÃ©solveur (8.8.8.8)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 3 : Interrogation serveur TLD .com                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur (8.8.8.8)
    â”‚
    â”‚ "OÃ¹ est www.example.com ?"
    â”‚
    â””â”€â”€â”€â”€â”€â†’ Serveur TLD .com (192.5.6.30) [a.gtld-servers.net]

Serveur TLD .com
    â”‚
    â”‚ "Je ne sais pas www.example.com,"
    â”‚ "mais voici les serveurs pour example.com :"
    â”‚
    â”‚ NS: ns1.example.com (203.0.113.10)
    â”‚ NS: ns2.example.com (203.0.113.11)
    â”‚
    â””â”€â”€â”€â”€â”€â†’ RÃ©solveur (8.8.8.8)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 4 : Interrogation serveur autoritaire                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur (8.8.8.8)
    â”‚
    â”‚ "Quelle est l'IP de www.example.com ?"
    â”‚
    â””â”€â”€â”€â”€â”€â†’ Serveur autoritaire (203.0.113.10) [ns1.example.com]

Serveur autoritaire (ns1.example.com)
    â”‚
    â”‚ "www.example.com a l'adresse 93.184.216.34"
    â”‚ "TTL: 300 secondes"
    â”‚
    â””â”€â”€â”€â”€â”€â†’ RÃ©solveur (8.8.8.8)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰tape 5 : Mise en cache et rÃ©ponse au client                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ©solveur (8.8.8.8)
    â”‚
    â”‚ Met en cache : www.example.com â†’ 93.184.216.34 (TTL: 300s)
    â”‚
    â”‚ "www.example.com = 93.184.216.34"
    â”‚
    â””â”€â”€â”€â”€â”€â†’ Ordinateur (192.168.1.100)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Temps total typique : 50-150ms                                   â”‚
â”‚                                                                  â”‚
â”‚ RequÃªtes suivantes (dans les 5 minutes) :                        â”‚
â”‚ Ordinateur â†’ RÃ©solveur â†’ RÃ©ponse depuis le cache (10-20ms)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Nombre de requÃªtes DNS effectuÃ©es :**
```
1 requÃªte du client â†’ rÃ©solveur
3 requÃªtes itÃ©ratives du rÃ©solveur :
  â””â”€ 1Ã— vers serveur racine
  â””â”€ 1Ã— vers serveur TLD
  â””â”€ 1Ã— vers serveur autoritaire
1 rÃ©ponse finale au client

Total : 4 messages UDP (en l'absence de cache)
```

## Le principe de dÃ©lÃ©gation

### Comment fonctionne la dÃ©lÃ©gation

La dÃ©lÃ©gation est le mÃ©canisme qui permet de distribuer la gestion du DNS.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Principe de dÃ©lÃ©gation                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ Racine (.) dit :                                            â”‚
â”‚ "Pour .com, demandez Ã  Verisign"                            â”‚
â”‚                                                             â”‚
â”‚ Verisign (.com) dit :                                       â”‚
â”‚ "Pour google.com, demandez Ã  Google"                        â”‚
â”‚                                                             â”‚
â”‚ Google (google.com) dit :                                   â”‚
â”‚ "Pour www.google.com, voici l'IP"                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Enregistrements de dÃ©lÃ©gation

La dÃ©lÃ©gation s'effectue via des enregistrements **NS** (Name Server).

**Exemple : DÃ©lÃ©gation de google.com dans la zone .com**
```
; Dans la zone .com (gÃ©rÃ© par Verisign)

google.com.         172800  IN  NS  ns1.google.com.
google.com.         172800  IN  NS  ns2.google.com.
google.com.         172800  IN  NS  ns3.google.com.
google.com.         172800  IN  NS  ns4.google.com.

; Glue records (nÃ©cessaires !)
ns1.google.com.     172800  IN  A   216.239.32.10
ns2.google.com.     172800  IN  A   216.239.34.10
ns3.google.com.     172800  IN  A   216.239.36.10
ns4.google.com.     172800  IN  A   216.239.38.10
```

**Pourquoi les glue records ?**
```
ProblÃ¨me du "chicken and egg" :

Pour trouver www.google.com, j'ai besoin de ns1.google.com
Pour trouver ns1.google.com, j'ai besoin de... ns1.google.com !
â†’ Boucle infinie !

Solution : Glue records
Le parent (.com) fournit directement l'IP de ns1.google.com
```

### Zones et sous-zones

Une zone peut Ãªtre divisÃ©e en sous-zones avec leur propre dÃ©lÃ©gation.

**Exemple : Organisation complexe**
```
example.com (zone parente)
    â”‚
    â”œâ”€ www.example.com (dans la mÃªme zone)
    â”œâ”€ mail.example.com (dans la mÃªme zone)
    â”‚
    â”œâ”€ france.example.com (sous-zone dÃ©lÃ©guÃ©e)
    â”‚   â””â”€ GÃ©rÃ©e par des serveurs NS diffÃ©rents
    â”‚       â€¢ ns1.france.example.com
    â”‚       â€¢ ns2.france.example.com
    â”‚
    â””â”€ usa.example.com (sous-zone dÃ©lÃ©guÃ©e)
        â””â”€ GÃ©rÃ©e par d'autres serveurs NS
            â€¢ ns1.usa.example.com
            â€¢ ns2.usa.example.com
```

**Fichier de zone example.com avec dÃ©lÃ©gations :**
```
; Zone example.com
$ORIGIN example.com.

; ... SOA, NS, A records pour example.com ...

; Enregistrements de la zone principale
www     IN  A       93.184.216.34
mail    IN  A       93.184.216.50

; DÃ©lÃ©gation vers sous-zone france.example.com
france  IN  NS      ns1.france.example.com.
france  IN  NS      ns2.france.example.com.
; Glue records
ns1.france  IN  A   198.51.100.10
ns2.france  IN  A   198.51.100.11

; DÃ©lÃ©gation vers sous-zone usa.example.com
usa     IN  NS      ns1.usa.example.com.
usa     IN  NS      ns2.usa.example.com.
; Glue records
ns1.usa     IN  A   203.0.113.20
ns2.usa     IN  A   203.0.113.21
```

**RÃ©solution de www.france.example.com :**
```
1. RÃ©solveur â†’ Serveur racine
   â†’ RÃ©ponse : "Demandez aux serveurs .com"

2. RÃ©solveur â†’ Serveur .com
   â†’ RÃ©ponse : "Demandez aux serveurs example.com"

3. RÃ©solveur â†’ ns1.example.com
   â†’ RÃ©ponse : "france.example.com est dÃ©lÃ©guÃ©,"
               "demandez Ã  ns1.france.example.com (198.51.100.10)"

4. RÃ©solveur â†’ ns1.france.example.com
   â†’ RÃ©ponse : "www.france.example.com = 198.51.100.50"
```

## Redondance et rÃ©silience

### Redondance au niveau des serveurs

**Best practices DNS :**
```
Minimum recommandÃ© : 2 serveurs NS
RecommandÃ© : 3-4 serveurs NS
Grandes organisations : 5+ serveurs NS

CritÃ¨res de distribution :
âœ“ RÃ©seaux diffÃ©rents (diffÃ©rents ASN)
âœ“ Localisations gÃ©ographiques diffÃ©rentes
âœ“ Fournisseurs diffÃ©rents
âœ“ Alimentation Ã©lectrique diffÃ©rente
```

**Exemple de configuration rÃ©siliente :**
```
example.com.

ns1.example.com     203.0.113.10    Datacenter Paris (OVH)
ns2.example.com     203.0.113.11    Datacenter Paris (OVH) - mÃªme DC
ns3.example.com     198.51.100.10   Datacenter Londres (AWS)
ns4.example.com     192.0.2.10      Datacenter New York (Google Cloud)
ns5.example.com     185.199.108.10  Anycast global (Cloudflare)
```

### Anycast pour la rÃ©silience

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Anycast DNS                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ Une mÃªme IP annoncÃ©e depuis plusieurs emplacements :    â”‚
â”‚                                                         â”‚
â”‚ ns1.example.com â†’ 203.0.113.10                          â”‚
â”‚   â”œâ”€ AnnoncÃ© depuis Paris                               â”‚
â”‚   â”œâ”€ AnnoncÃ© depuis Londres                             â”‚
â”‚   â”œâ”€ AnnoncÃ© depuis New York                            â”‚
â”‚   â””â”€ AnnoncÃ© depuis Tokyo                               â”‚
â”‚                                                         â”‚
â”‚ Le routage Internet dirige automatiquement              â”‚
â”‚ vers l'instance la plus proche                          â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Avantages :
âœ“ Latence minimale
âœ“ Si une instance tombe, trafic redirigÃ© automatiquement
âœ“ Protection DDoS (charge distribuÃ©e)
âœ“ Pas de configuration cÃ´tÃ© client
```

### Comportement en cas de panne

**ScÃ©nario : ns1.example.com tombe**
```
RÃ©solveur interroge la liste des NS :
1. Essai ns1.example.com â†’ Timeout (2 secondes)
2. Essai ns2.example.com â†’ SuccÃ¨s !
   â†’ RÃ©pond en 50ms

Impact pour l'utilisateur :
â€¢ PremiÃ¨re requÃªte : 2 secondes de dÃ©lai (timeout)
â€¢ RequÃªtes suivantes : ns2 directement (rÃ©solveur apprend)
â€¢ Total : LÃ©ger ralentissement, pas de panne totale

C'est pour cela qu'avoir plusieurs NS est crucial !
```

## Visualisation complÃ¨te de l'architecture

```
                         Internet
                            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Client â”‚             â”‚RÃ©solveur â”‚           â”‚RÃ©solveur â”‚
â”‚       â”‚             â”‚ rÃ©cursif â”‚           â”‚ rÃ©cursif â”‚
â”‚(Vous) â”‚             â”‚ (8.8.8.8)â”‚           â”‚(1.1.1.1) â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                       â”‚                     â”‚
    â”‚ 1. www.example.com ?  â”‚                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                     â”‚
                            â”‚                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
                    â†“                 â”‚           â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚           â”‚
            â”‚Serveurs racineâ”‚         â”‚           â”‚
            â”‚(. root)       â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
            â”‚13 adresses IP â”‚  2. OÃ¹  â”‚           â”‚
            â”‚1000+ instancesâ”‚  est    â”‚           â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  .com ? â”‚           â”‚
                    â”‚          â”‚      â”‚           â”‚
                    â”‚ 3. Demande      â”‚           â”‚
                    â”‚    a.gtld-      â”‚           â”‚
                    â”‚    servers.net  â”‚           â”‚
                    â†“          â”‚      â”‚           â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚      â”‚           â”‚
            â”‚Serveurs TLD  â”‚â†â”€â”€â”˜      â”‚           â”‚
            â”‚(.com, .org,  â”‚  4. OÃ¹   â”‚           â”‚
            â”‚ .fr, ...)    â”‚  est     â”‚           â”‚
            â”‚Verisign, etc.â”‚  example â”‚           â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  .com ?  â”‚           â”‚
                   â”‚          â”‚       â”‚           â”‚
                   â”‚ 5. Demande       â”‚           â”‚
                   â”‚    ns1.example   â”‚           â”‚
                   â”‚    .com          â”‚           â”‚
                   â†“          â”‚       â”‚           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚           â”‚
         â”‚Serveurs        â”‚â†â”€â”€â”˜       â”‚           â”‚
         â”‚autoritaires    â”‚ 6. www    â”‚           â”‚
         â”‚example.com     â”‚ .example  â”‚           â”‚
         â”‚ns1, ns2, ns3...â”‚ .com ?    â”‚           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚           â”‚
                  â”‚          â”‚        â”‚           â”‚
                  â”‚ 7. C'est â”‚        â”‚           â”‚
                  â”‚    93.184â”‚        â”‚           â”‚
                  â”‚    .216.34        â”‚           â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚        â”‚           â”‚
                             â”‚        â”‚           â”‚
                             â”‚   8. RÃ©ponse       â”‚
                             â””â”€â”€â”€â”€â”€â”€â†’  Client     â”‚
                                                  â”‚
                                       (Processus â”‚
                                       similaire) â”‚
                                                  â†“
```

## RÃ©sumÃ© des concepts clÃ©s

| Niveau | RÃ´le | Exemple | Nombre |
|--------|------|---------|--------|
| **Racine** | ConnaÃ®t les TLD | `.` | 13 adresses (1000+ instances) |
| **TLD** | ConnaÃ®t les domaines | `.com`, `.fr` | ~1500 TLD |
| **Autoritaire** | Source de vÃ©ritÃ© | `ns1.google.com` | Millions |
| **RÃ©cursif** | Agent de rÃ©solution | `8.8.8.8` | Des milliers |

## Points clÃ©s Ã  retenir

ğŸ”‘ **DNS utilise une architecture hiÃ©rarchique en arbre inversÃ©**

ğŸ”‘ **13 adresses IP de serveurs racine, mais 1000+ instances via Anycast**

ğŸ”‘ **Chaque niveau dÃ©lÃ¨gue la responsabilitÃ© au niveau infÃ©rieur via des enregistrements NS**

ğŸ”‘ **Les serveurs autoritaires contiennent les informations officielles d'une zone**

ğŸ”‘ **Les rÃ©solveurs rÃ©cursifs font tout le travail pour les clients**

ğŸ”‘ **La redondance est cruciale : minimum 2 NS, idÃ©alement 3-4+**

ğŸ”‘ **Les glue records rÃ©solvent le problÃ¨me du "chicken and egg"**

ğŸ”‘ **Anycast permet distribution gÃ©ographique et rÃ©silience**

ğŸ”‘ **La dÃ©lÃ©gation permet de distribuer la gestion de milliards de noms**

---

## Ce que nous avons appris

Dans cette section, nous avons explorÃ© en dÃ©tail :

- âœ… La structure hiÃ©rarchique complÃ¨te du DNS
- âœ… Les serveurs racine et leur distribution mondiale
- âœ… Les serveurs TLD et leur rÃ´le de dÃ©lÃ©gation
- âœ… Les serveurs autoritaires (primaires et secondaires)
- âœ… Les rÃ©solveurs rÃ©cursifs et leur fonctionnement
- âœ… Le processus complet de rÃ©solution (Ã©tape par Ã©tape)
- âœ… Le mÃ©canisme de dÃ©lÃ©gation et les glue records
- âœ… Les fichiers de zone et les transferts de zone
- âœ… La redondance et la rÃ©silience via Anycast
- âœ… Comment tous ces Ã©lÃ©ments s'articulent ensemble

## Pour aller plus loin

Maintenant que vous comprenez l'architecture hiÃ©rarchique, nous allons approfondir les **types d'enregistrements DNS** en dÃ©tail : A, AAAA, CNAME, MX, TXT, SRV, et bien d'autres, avec leurs cas d'usage spÃ©cifiques.

---

**Prochaine section : Types d'enregistrements DNS** ğŸ‘‰

â­ï¸ [Types d'enregistrements (A, AAAA, CNAME, MX, TXT, etc.)](/05-couche-application/02.2-dns-types-enregistrements.md)
